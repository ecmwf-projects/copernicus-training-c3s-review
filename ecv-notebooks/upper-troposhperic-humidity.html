
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tutorial on Analysis of Upper Tropospheric Humidity (UTH) using climate data from C3S &#8212; C3S Training</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ecv-notebooks/upper-troposhperic-humidity';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="C3S Training - Home"/>
    <script>document.write(`<img src="../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="C3S Training - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Copernicus Climate Change Service (C3S) Data Tutorials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Climate Data Store (CDS)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cds-tutorial.html">CDS tutorial</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reanalysis Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reanalysis-climatology.html">Climatology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reanalysis-heatwave.html">Heatwave Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../projections-cmip6.html">Climate Projections (CMIP6)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projections-cordex.html">Climate Projections (CORDEX)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sf-anomalies.html">Seasonal Forecast Anomalies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sf-verification.html">Seasonal Forecast Verification</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Climate Indices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ci-windchill.html">Windchill Index Calculation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials using Satellite Observations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="erb-outgoing-longwave-radiation.html">Outgoing Longwave Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="erb-clara-climatology.html">Analysis of the CLARA Earth radiation budget product</a></li>
<li class="toctree-l1"><a class="reference internal" href="erb-ceres-climatology.html">Analysis of the CERES Earth radiation budget product</a></li>
<li class="toctree-l1"><a class="reference internal" href="total-solar-irradiance.html">Total Solar Irradiance</a></li>
<li class="toctree-l1"><a class="reference internal" href="srb-climatology-and-anomaly.html">Surface radiation budget climatologies and anomalies</a></li>
<li class="toctree-l1"><a class="reference internal" href="total-column-water-vapour-combi.html">Exploring Total Column Water Vapour information in the COMBI dataset</a></li>

<li class="toctree-l1"><a class="reference internal" href="tropospheric-humidity-from-radio-occultation.html">Tropospheric humidity estimates from satellite-based radio occultation measurements</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloud-cover-climatology.html">Cloud fractional cover climatology</a></li>
<li class="toctree-l1"><a class="reference internal" href="greenhouse-gases-level2-products.html">Greenhouse Gas Level 2 Products</a></li>
<li class="toctree-l1"><a class="reference internal" href="greenhouse-gases-level3-products.html">How to access, read and use satellite XCO2 and XCH4 Level 3 data products</a></li>


<li class="toctree-l1"><a class="reference internal" href="aerosol-single-sensor-demonstrator.html">Exploring gridded data on Aerosol properties available on C3S</a></li>
<li class="toctree-l1"><a class="reference internal" href="aerosol-multi-sensor-record.html">Visualising a full Climate Data Record of multi-sensor Aerosol data</a></li>


<li class="toctree-l1"><a class="reference internal" href="total-ozone-columns.html">Exploring an ozone product available through the Climate Data Store (CDS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="soil-moisture-anomalies.html"><strong>C3S Soil Moisture Data Access and Anomaly Analysis Notebook</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="lake-water-level.html">Tutorial: Data Access and  Visualisation of Lake Water Level (LWL) timeseries</a></li>




<li class="toctree-l1"><a class="reference internal" href="lake-surface-water-temperature.html">Visualisation of Lake Surface Water Temperature (LSWT) data for a given lake</a></li>




<li class="toctree-l1"><a class="reference internal" href="viewer-for-sealevel-product.html">Looking at Sea Level data during an El Niño episode</a></li>
<li class="toctree-l1"><a class="reference internal" href="ice-sheet-surface-elevation.html">Ice sheet surface elevation change rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="ice-sheet-velocity.html">Access and visualisation of the Greenland Ice Sheet velocity data</a></li>
<li class="toctree-l1"><a class="reference internal" href="ice-sheet-mass-balance.html">Exploring Ice sheet Gravimetric Mass Balance data, available through the C3S Climate Data Store</a></li>

<li class="toctree-l1"><a class="reference internal" href="glacier-area.html">Explore glacier area</a></li>
<li class="toctree-l1"><a class="reference internal" href="glacier-mass-change.html">Glacier mass change</a></li>
<li class="toctree-l1"><a class="reference internal" href="mean-with-inverse-variance-weights.html">Computing the time average of LAI and fAPAR using inverse variance weights</a></li>

<li class="toctree-l1"><a class="reference internal" href="precipitation-giraffe.html">Exploring Precipitation information in the GIRAFE dataset</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Turorials using Copernicus Emergency Management Service data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cems-notebooks/visualising-fwi-for-esotc.html">Visualising fire weather index (FWI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cems-notebooks/glofas-bangladesh-floods.html">Observing major flood events</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Bias Correction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://ibicus.readthedocs.io/en/latest/getting_started/overview.html">Python library (ibicus) and tutorials on bias correction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Atmosphere Monitoring Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://ecmwf-projects.github.io/copernicus-training-cams/">Tutorials from the Copernicus Atmosphere Monitoring Service (CAMS)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-c3s-review/review?urlpath=tree/ecv-notebooks/upper-troposhperic-humidity.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/copernicus-training-c3s-review" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/copernicus-training-c3s-review/issues/new?title=Issue%20on%20page%20%2Fecv-notebooks/upper-troposhperic-humidity.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/ecv-notebooks/upper-troposhperic-humidity.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tutorial on Analysis of Upper Tropospheric Humidity (UTH) using climate data from C3S</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-access-the-notebook">How to access the notebook</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outline">Outline</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rationale">Rationale</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data">2. Retrieve data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-data">Get the data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#open-noaa-data-with-xarray">Open NOAA data with xarray</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#uth-variation-and-climatology-over-europe">3. UTH variation and climatology over Europe</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-temporal-mean-over-europe">Calculation of temporal mean over Europe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-temporal-mean-over-europe">Plot of temporal mean over Europe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-climatology-over-europe">Calculation of climatology over Europe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-climatology-over-europe">Plot of climatology over Europe</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-uth-distribution-seasonal-variation-and-annual-cycle">4. Global UTH distribution, seasonal variation and annual cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-temporal-mean-with-global-coverage">4.1 Calculation of temporal mean with global coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-temporal-mean-with-global-coverage">4.2 Plot of temporal mean with global coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-seasonal-average-with-global-coverage">4.3 Calculation of seasonal average with global coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-seasonal-average-with-global-coverage">4.4 Plot of seasonal average with global coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-annual-cycle-with-global-coverage">4.5 Calculation of annual cycle with global coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-annual-cycle-with-global-coverage">4.6 Plot of annual cycle with global coverage</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#literature">5. Literature</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="tutorial-on-analysis-of-upper-tropospheric-humidity-uth-using-climate-data-from-c3s">
<h1>Tutorial on Analysis of Upper Tropospheric Humidity (UTH) using climate data from C3S<a class="headerlink" href="#tutorial-on-analysis-of-upper-tropospheric-humidity-uth-using-climate-data-from-c3s" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>This tutorial is about Upper Tropospheric Humidity (UTH) as a part of the Essential Climate Variable (ECV) <i>Water Vapour</i>. We will learn how to access the data from the Climate Data Store (CDS) of the Copernicus Climate Change Service (C3S) and present an idea how to process and visualize the data following. Once you feel comfortable with the python code, you are invited to adjust or extend the code according to your interests! To run each section (either HTML or python sections) just press <strong>Shift</strong> + <strong>Enter</strong> and the code will be executed. After a short introduction how to use a Jupyter notebook it goes right away with the analysis!</p>
<p><img alt="logo" src="../_images/uth-overview.png" /></p>
<section id="how-to-access-the-notebook">
<h3>How to access the notebook<a class="headerlink" href="#how-to-access-the-notebook" title="Link to this heading">#</a></h3>
<p>This tutorial is in the form of a <a class="reference external" href="https://jupyter.org/">Jupyter notebook</a>. You will not need to install any software for the training as there are a number of free cloud-based services to create, edit, run and export Jupyter notebooks such as this. Here are some suggestions (simply click on one of the links below to run the notebook):</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Binder</p></th>
<th class="head text-center"><p>Kaggle</p></th>
<th class="head text-center"><p>Colab</p></th>
<th class="head text-center"><p>NBViewer</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><a class="reference external" href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training/HEAD?urlpath=lab/tree/C3S_climate-data-store.ipynb"><img alt="Binder" src="https://mybinder.org/badge.svg" /></a></p></td>
<td class="text-center"><p><a class="reference external" href="https://kaggle.com/kernels/welcome?src=https://github.com/ecmwf-projects/copernicus-training/blob/master/C3S_climate-data-store.ipynb"><img alt="Kaggle" src="https://kaggle.com/static/images/open-in-kaggle.svg" /></a></p></td>
<td class="text-center"><p><a class="reference external" href="https://colab.research.google.com/github/ecmwf-projects/copernicus-training/blob/master/C3S_climate-data-store"><img alt="Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p></td>
<td class="text-center"><p><a class="reference external" href="https://nbviewer.jupyter.org/github/ecmwf-projects/copernicus-training/blob/master/C3S_climate-data-store.ipynb"><img alt="NBViewer" src="https://raw.githubusercontent.com/ecmwf-projects/copernicus-training/master/img/nbviewer_badge.svg" /></a></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>(Binder may take some time to load, so please be patient!)</p></td>
<td class="text-center"><p>(will need to login/register, and switch on the internet via <em>settings</em>)</p></td>
<td class="text-center"><p>(will need to run the command <code class="docutils literal notranslate"><span class="pre">!pip</span> <span class="pre">install</span> <span class="pre">cartopy</span></code> before importing the libraries)</p></td>
<td class="text-center"><p>(this will not run the notebook, only render it)</p></td>
</tr>
</tbody>
</table>
</div>
<p>If you would like to run this notebook in your own environment, we suggest you install <a class="reference external" href="https://docs.anaconda.com/anaconda/install/">Anaconda</a>, which contains most of the libraries you will need. You will also need to install <a class="reference external" href="http://xarray.pydata.org/en/stable/">Xarray</a> for working with multidimensional data in netcdf files, and the CDS API (<code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">cdsapi</span></code>) for downloading data programatically from the CDS.</p>
</section>
<section id="outline">
<h3>Outline<a class="headerlink" href="#outline" title="Link to this heading">#</a></h3>
<p>These include a brief introduction into the variable followed by a step-by-step guidance how to retrieve the data. With this done the focus is on analysing and visualising the data in various ways.</p>
<ol class="arabic simple">
<li><p>Introduction</p></li>
<li><p>Retrieve data</p></li>
<li><p>UTH variation and climatology over Europe</p>
<ul class="simple">
<li><p>Temporal mean over Europe</p></li>
<li><p>Climatology over Europe</p></li>
</ul>
</li>
<li><p>Global UTH distribution, seasonal variation and annual cycle</p>
<ul class="simple">
<li><p>Temporal mean with global coverage</p></li>
<li><p>Seasonal average with global coverage</p></li>
<li><p>Annual cycle with global coverage</p></li>
</ul>
</li>
<li><p>Literature</p></li>
</ol>
</section>
<section id="rationale">
<h3>Rationale<a class="headerlink" href="#rationale" title="Link to this heading">#</a></h3>
<p>Upper Tropospheric Humidity (UTH) is part of the Essential Climate Variable (ECV) Inventory of <i>Water Vapour</i> together with Total Column Water Vapour (TCWV) and Tropospheric Humidity Profiles.</p>
<p>UTH and Water vapour in general is an important greenhouse gas. Water vapour accounts for 85-90% of the greenhouse effect since it emits and absorbs the earth’s outgoing longwave radiation at many wavelenghts and has by far the most occurance compared to other greenhouse gases <a class="reference internal" href="#Literature"><span class="xref myst">[1]</span></a>. It is mostly not anthropogenic and therefore less present in the media but indeed important to monitor for understanding it’s trend and impact on climate change. UTH is relevant for atmospheric processes like cloud formation/feedback and has also an indirect effect on global warming:
Emissions of anthropogenic greenhouse gases like carbon dioxide and methane lead to a warmer atmosphere due to the greenhouse effect. The warmer air in turn is able to contain more water vapour compared to colder air which potentially leads to increased water vapour concentrations. This amplifies the positive impact of anthropogenic emissions on global warming and is a net positive feedback effect <a class="reference internal" href="#Literature"><span class="xref myst">[2]</span></a>.</p>
<p>The following investigated dataset on UTH was derived from the AMSU-B and MHS microwave humidity sounders on board the NOAA-(NOAA-15, -16, -17, -18, -19) and MetOp-(MetOp-A, -B, -C) satellite series from 1999-present with a global coverage of 1.0°x1.0° resolution and daily averages. The term “upper tropospheric” refers to a pressure level of 500 - 200 hPa, which corresponds to an altitude of about 5.5 - 12 km.</p>
<p>The TCDR part of the dataset (1999-2015) is brokered to the Climate Data Store (CDS) by Met Office and was originally produced on behalf of EUMETSAT’S Satellite Application Facility on Climate Change (CM SAF). The ICDR part (2016-present) has been directly delivered to the Climate Data Store and was originally produced on behalf of the Copernicus Climate Change Services (C3S) by the Met Office.</p>
<p>In the following, some simple analysis and illustrations are presented to give a general overview on the variable as well as ideas how to use the data. It comprises global/european distributions alongside climatologies and anomalies. Hopefully, after the tutorial you will be able to explore other regions or other time periods and adapt the python code according to your interests!</p>
<p>Please find further information about the dataset as well as the data in the Climate Data Store sections “Overview”, “Download data” and “Documentation” of the Landing page:</p>
<ul class="simple">
<li><p>Upper Tropospheric Humidity: <a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-upper-troposphere-humidity?tab=overview">https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-upper-troposphere-humidity?tab=overview</a></p></li>
</ul>
</section>
</section>
<section id="retrieve-data">
<h2>2. Retrieve data<a class="headerlink" href="#retrieve-data" title="Link to this heading">#</a></h2>
<p>This tutorial assumes that you have installed the cdsapi and configured you .cdsapirc file with your key, as described in the “Climate Data Store Tutorial”.</p>
<section id="import-libraries">
<h3>Import libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h3>
<p>Processing (climate) data with python requires some libraries. Libraries contain different functions for e.g. reading, processing and visualizing large amounts of data and make it easier to work with it.</p>
<p>The basic data format for climate data is NetCDF. This is also the case for the UTH dataset and to handle this well we use a library to work with multidimensional arrays, named <strong>Xarray</strong>. For the calculations we use <strong>Numpy</strong>, which provides various mathmatical operations. We also need libraries for plotting and viewing the data, in this case we will use <strong>Matplotlib</strong> and <strong>Cartopy</strong> with some sublibraries.</p>
<p>Before we start analysing the data we need to take advantage of one of the two options to get the data:</p>
<ul class="simple">
<li><p>Fill in the download form on the CDS page and simply download the data to the download folder of your computer - not preferred</p></li>
<li><p>Use the API (Application Programming Interface) for programmatic access to the CDS data - preferred, check <a class="reference internal" href="#cds_api_key"><span class="xref myst">2.2 Enter CDS API key</span></a></p></li>
</ul>
<p>For this we import the <strong>cdsapi</strong> and <strong>urllib</strong> libraries as well.</p>
<p>Please make sure you are using a compatible python version. This Notebook was created in python 3.9.14. In case your version is &lt;3.9 an error message will appear and you might consider to update your python version.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for correct python version, this results in an error message if your python version is &lt;3.9</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Must be using Python 3. Minor version &gt;= 9&quot;</span><span class="p">)</span>

<span class="c1"># Download data from CDS via cdsapi and urllib</span>
<span class="kn">import</span> <span class="nn">cdsapi</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="kn">import</span> <span class="nn">urllib</span>


<span class="c1"># Libraries for data reading and processing</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Libraries for visualisation in form of maps or graphs</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="c1"># Sublibraries to make to plots more readable</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">LongitudeFormatter</span><span class="p">,</span> <span class="n">LatitudeFormatter</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-the-data">
<h3>Get the data<a class="headerlink" href="#get-the-data" title="Link to this heading">#</a></h3>
<p>For this tutorial we want data for Upper Tropospheric Humidity, so please either click on “Datasets” in the CDS and search for “Upper Tropospheric Humidity” or simply click on: <a class="reference external" href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-upper-troposphere-humidity?tab=overview">https://cds.climate.copernicus.eu/cdsapp#!/dataset/satellite-upper-troposphere-humidity?tab=overview</a>.
The name of the UTH landing page is: <strong>Upper tropospheric humidity gridded data from 1999 to present derived from satellite observations</strong>.</p>
<p>Once you reached the landing page, feel free to have a look at the documentation and information provided.</p>
<p>The data can be found in the “Download data”-tab with a form to select certain satellites, years etc. For our Use Case we want to compare the Upper Tropospheric Humidity from two different satellites and are therefore interested in the following setup:</p>
<ul class="simple">
<li><p>Sensor on satellite: MHS on NOAA-18</p></li>
<li><p>Year: Every year from 2007-2018</p></li>
<li><p>Month: Every month from January to December</p></li>
<li><p>Day: Every day from 01-31</p></li>
<li><p>Variable: All available variables</p></li>
<li><p>Format: Zip file (.zip)</p></li>
<li><p>Geographical area: Whole available region</p></li>
</ul>
<p>Please make sure all <strong>Terms of use</strong> are accepted. This can be done at the bottom of the <strong>Download data</strong> tab.</p>
<p>The current directory <strong>‘./’</strong> is defined as <strong>datadir</strong>. This is the central directory where we will create subfolders to save the data and output files. In case you want to define a specific directory where to save the data and output, please feel free to enter the path:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datadir</span> <span class="o">=</span> <span class="s1">&#39;./data_dir/&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">datadir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><em>Note: There is a request limit on downloads which makes the number of files per download request restricted to about one year (400 files). To get 12 years of data we need to be creative and prepare a loop. The loop downloads every year individual and concatenates each year to the therefore growing time series afterwards.</em></p>
<p>What we use to retrieve the data is a combination of the API method and the C3S-Toolbox. The C3S-Toolbox provides the chance to retrieve, process and visualize the data with basic python skills in the Toolbox-Environment, which means to run it all online within the CDS and without the need of a powerful computer or a lot of storage. But we just take advantage of the data retrieval part of the C3S-Toolbox and combine it with the API method.</p>
<p>The following section contains the toolbox code (red color) and saves it as “multiline_str”. This is executed and then downloaded at the end. To keep track of things please create manually a folder called <strong>Data</strong> in the <strong>datadir</strong> directory and store the nc-file with an appropriatie name in this folder.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CDS API client</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>

<span class="c1"># Start and end year</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">2007</span>
<span class="n">end</span> <span class="o">=</span> <span class="mi">2008</span>

<span class="c1"># Empty list to fill with date files</span>
<span class="n">noaa_data_files</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop from start to end year</span>
<span class="k">for</span> <span class="n">yy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">end</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">DL_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}</span><span class="s1">download_uth_noaa18_</span><span class="si">{</span><span class="n">yy</span><span class="si">}</span><span class="s1">.zip&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DL_file</span><span class="p">):</span>
        <span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
            <span class="s1">&#39;satellite-upper-troposphere-humidity&#39;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span>
                <span class="s1">&#39;sensor_on_satellite&#39;</span><span class="p">:</span> <span class="s1">&#39;mhs_on_noaa_18&#39;</span><span class="p">,</span>
                <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">yy</span><span class="p">),</span>
                <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%02d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">mnth</span><span class="p">)</span> <span class="k">for</span> <span class="n">mnth</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">)],</span>
                <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%02d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">day</span><span class="p">)</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="p">)],</span>
            <span class="p">}</span>
        <span class="p">)</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">DL_file</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">DL_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
        <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">datadir</span><span class="p">)</span>
        <span class="n">noaa_data_files</span> <span class="o">+=</span> <span class="n">zip_ref</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">noaa_data_files</span><span class="p">)</span><span class="si">}</span><span class="s2"> files for NOAA-18&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="open-noaa-data-with-xarray">
<h4>Open NOAA data with xarray<a class="headerlink" href="#open-noaa-data-with-xarray" title="Link to this heading">#</a></h4>
<p>We can open the downloaded files <code class="docutils literal notranslate"><span class="pre">xarray.open_mfdataset</span></code> (which requires dask to be installed). This will lazily load the data (i.e. not into RAM, but ready to be processed when required).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Before opening we will ensure that the data files list is sorted</span>
<span class="nb">sorted</span><span class="p">(</span><span class="n">noaa_data_files</span><span class="p">)</span>
<span class="n">dataset_noaa18</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">([</span><span class="n">datadir</span><span class="o">+</span><span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">noaa_data_files</span><span class="p">],</span> <span class="n">combine</span><span class="o">=</span><span class="s1">&#39;by_coords&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To compare the data with another satellite we repeat the steps for MetOp-A:</p>
<ul class="simple">
<li><p>Sensor on satellite: MHS on Metop-A</p></li>
<li><p>Year: Every year from 2007-2018</p></li>
<li><p>Month: Every month from January to December</p></li>
<li><p>Day: Every day from 01-31</p></li>
<li><p>Variable: All available variables</p></li>
<li><p>Format: Zip file (.zip)</p></li>
<li><p>Geographical area: Whole available region</p></li>
</ul>
<p>Please repeat the steps and adjust the code accordingly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>


<span class="c1"># Empty list to fill with date files</span>
<span class="n">metop_a_data_files</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Loop from start to end year</span>
<span class="k">for</span> <span class="n">yy</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">start</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">end</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">DL_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">datadir</span><span class="si">}</span><span class="s1">download_uth_metop_a_</span><span class="si">{</span><span class="n">yy</span><span class="si">}</span><span class="s1">.zip&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DL_file</span><span class="p">):</span>
        <span class="n">c</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span>
            <span class="s1">&#39;satellite-upper-troposphere-humidity&#39;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;all&#39;</span><span class="p">,</span>
                <span class="s1">&#39;sensor_on_satellite&#39;</span><span class="p">:</span> <span class="s1">&#39;mhs_on_metop_a&#39;</span><span class="p">,</span>
                <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">yy</span><span class="p">),</span>
                <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%02d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">mnth</span><span class="p">)</span> <span class="k">for</span> <span class="n">mnth</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">)],</span>
                <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%02d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">day</span><span class="p">)</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="p">)],</span>
            <span class="p">}</span>
        <span class="p">)</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">DL_file</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">DL_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
        <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">datadir</span><span class="p">)</span>
        <span class="n">metop_a_data_files</span> <span class="o">+=</span> <span class="n">zip_ref</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">metop_a_data_files</span><span class="p">)</span><span class="si">}</span><span class="s2"> files for Metop-A&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-08-28 08:28:08,438 INFO Request ID is 8a142e1f-b3b4-4541-8006-8094d8616ff6
2024-08-28 08:28:08,492 INFO status has been updated to accepted
2024-08-28 08:28:10,048 INFO status has been updated to running
2024-08-28 08:32:25,707 INFO Creating download object as zip with files:
[&#39;UTHdm20070101000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070102000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070103000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070104000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070105000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070106000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070107000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070108000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070109000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070110000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070111000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070112000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070113000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070114000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070115000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070116000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070117000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070118000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070119000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070120000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070121000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070122000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070123000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070124000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070125000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070126000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070127000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070128000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070129000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070130000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070131000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070201000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070202000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070203000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070204000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070205000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070206000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070207000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070208000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070209000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070210000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070211000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070212000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070213000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070214000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070215000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070216000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070217000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070218000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070219000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070220000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070221000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070222000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070223000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070224000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070225000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070226000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070227000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070228000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070301000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070302000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070303000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070304000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070305000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070306000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070307000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070308000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070309000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070310000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070311000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070312000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070313000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070314000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070315000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070316000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070317000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070318000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070319000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070320000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070321000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070322000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070323000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070324000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070325000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070326000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070327000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070328000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070329000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070330000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070331000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070401000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070402000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070403000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070404000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070405000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070406000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070407000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070408000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070409000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070410000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070411000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070412000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070413000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070414000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070415000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070416000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070417000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070418000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070419000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070420000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070424000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070425000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070426000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070427000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070428000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070429000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070430000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070501000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070502000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070503000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070504000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070505000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070506000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070507000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070508000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070509000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070510000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070511000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070512000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070513000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070514000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070515000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070516000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070517000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070518000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070519000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070520000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070521000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070522000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070523000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070524000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070525000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070526000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070527000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070528000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070529000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070530000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070531000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070601000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070602000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070603000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070604000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070605000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070606000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070607000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070608000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070609000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070610000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070611000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070612000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070613000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070614000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070615000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070616000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070617000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070618000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070619000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070620000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070621000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070622000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070623000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070624000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070625000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070626000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070627000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070628000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070629000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070630000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070701000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070702000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070703000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070704000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070705000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070706000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070707000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070708000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070709000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070710000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070711000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070712000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070713000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070714000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070715000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070716000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070717000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070718000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070719000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070720000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070721000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070722000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070723000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070724000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070725000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070726000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070727000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070728000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070729000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070730000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070731000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070801000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070802000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070803000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070804000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070805000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070806000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070807000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070808000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070809000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070810000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070811000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070812000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070813000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070814000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070815000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070816000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070817000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070818000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070819000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070820000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070821000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070822000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070823000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070824000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070825000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070826000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070827000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070828000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070829000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070830000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070831000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070901000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070902000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070903000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070904000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070905000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070906000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070907000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070908000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070909000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070910000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070911000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070912000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070913000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070914000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070915000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070916000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070917000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070919000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070920000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070921000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070922000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070923000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070924000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070925000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070926000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070927000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070928000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070929000000120MHMEA01GL.nc&#39;, &#39;UTHdm20070930000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071001000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071002000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071003000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071004000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071005000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071006000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071007000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071008000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071009000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071010000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071011000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071012000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071013000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071014000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071015000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071016000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071017000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071018000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071019000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071020000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071021000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071022000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071023000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071024000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071025000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071026000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071027000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071028000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071029000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071030000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071031000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071101000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071102000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071103000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071104000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071105000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071106000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071107000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071108000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071109000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071110000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071111000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071112000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071113000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071114000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071115000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071116000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071117000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071118000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071119000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071120000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071121000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071122000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071123000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071124000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071125000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071126000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071127000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071128000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071129000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071130000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071201000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071202000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071203000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071204000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071205000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071206000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071207000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071208000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071209000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071210000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071211000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071212000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071213000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071214000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071215000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071216000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071217000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071218000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071219000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071220000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071221000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071222000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071223000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071224000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071225000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071226000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071227000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071228000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071229000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071230000000120MHMEA01GL.nc&#39;, &#39;UTHdm20071231000000120MHMEA01GL.nc&#39;]
2024-08-28 08:32:25,708 INFO status has been updated to successful
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "d8f35453a9154a11a7aabf40f369175b", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2024-08-28 08:34:52,020 INFO Request ID is 28002eb0-c125-4eee-9890-dcf6cd87c34e
2024-08-28 08:34:52,064 INFO status has been updated to accepted
2024-08-28 08:34:53,618 INFO status has been updated to running
2024-08-28 08:39:09,234 INFO Creating download object as zip with files:
[&#39;UTHdm20080101000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080102000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080103000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080104000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080105000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080106000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080107000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080108000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080109000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080110000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080111000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080112000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080113000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080114000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080115000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080116000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080118000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080119000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080120000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080121000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080122000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080123000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080124000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080125000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080126000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080127000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080128000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080129000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080130000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080131000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080201000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080202000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080203000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080204000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080205000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080206000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080207000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080208000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080209000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080210000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080211000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080212000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080213000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080214000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080215000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080216000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080217000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080218000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080219000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080220000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080221000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080222000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080223000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080224000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080225000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080226000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080227000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080228000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080229000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080301000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080302000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080303000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080304000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080305000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080306000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080307000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080308000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080309000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080310000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080311000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080312000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080313000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080314000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080315000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080316000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080317000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080318000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080319000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080322000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080323000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080324000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080325000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080326000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080327000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080328000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080329000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080330000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080331000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080401000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080402000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080403000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080404000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080405000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080406000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080407000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080408000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080409000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080410000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080411000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080412000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080413000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080414000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080415000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080416000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080417000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080418000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080419000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080420000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080421000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080422000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080423000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080424000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080425000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080426000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080427000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080428000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080429000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080430000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080501000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080502000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080503000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080504000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080505000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080506000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080507000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080508000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080509000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080510000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080511000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080512000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080513000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080514000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080515000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080516000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080517000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080518000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080519000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080520000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080521000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080522000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080523000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080524000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080525000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080526000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080527000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080528000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080529000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080530000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080531000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080601000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080602000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080603000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080604000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080605000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080606000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080607000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080608000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080609000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080610000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080611000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080612000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080613000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080614000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080615000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080616000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080617000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080618000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080619000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080620000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080621000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080622000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080623000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080624000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080625000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080626000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080627000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080628000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080629000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080630000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080701000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080702000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080703000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080704000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080705000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080706000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080707000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080708000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080709000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080710000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080711000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080712000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080713000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080714000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080715000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080716000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080717000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080718000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080719000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080720000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080721000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080722000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080723000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080724000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080725000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080726000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080727000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080728000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080729000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080730000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080731000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080801000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080802000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080803000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080804000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080805000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080806000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080807000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080808000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080809000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080810000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080811000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080812000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080813000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080814000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080815000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080816000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080817000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080818000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080819000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080820000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080821000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080822000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080823000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080824000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080825000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080826000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080827000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080828000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080829000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080830000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080831000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080901000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080902000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080903000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080904000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080905000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080906000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080907000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080908000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080909000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080910000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080911000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080912000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080913000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080914000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080915000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080916000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080917000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080918000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080919000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080920000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080921000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080922000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080923000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080924000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080925000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080926000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080927000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080928000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080929000000120MHMEA01GL.nc&#39;, &#39;UTHdm20080930000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081001000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081002000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081003000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081004000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081005000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081006000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081007000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081008000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081009000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081010000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081011000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081012000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081013000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081014000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081015000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081016000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081017000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081018000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081019000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081020000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081021000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081022000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081023000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081024000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081025000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081026000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081027000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081028000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081029000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081030000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081031000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081101000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081102000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081103000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081104000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081105000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081106000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081107000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081108000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081109000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081110000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081111000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081112000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081113000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081114000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081115000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081116000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081117000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081118000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081119000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081120000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081121000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081122000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081123000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081124000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081125000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081126000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081127000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081128000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081129000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081130000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081201000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081202000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081203000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081204000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081205000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081206000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081207000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081208000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081209000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081210000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081211000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081212000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081213000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081214000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081215000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081216000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081217000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081218000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081219000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081220000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081221000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081222000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081223000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081224000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081225000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081226000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081227000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081228000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081229000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081230000000120MHMEA01GL.nc&#39;, &#39;UTHdm20081231000000120MHMEA01GL.nc&#39;]
2024-08-28 08:39:09,235 INFO status has been updated to successful
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "61775f37e43e46a385643182fed7cfeb", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloaded 724 files for Metop-A
</pre></div>
</div>
</div>
</div>
<p>With the files at the correct place we can start reading and processing the data. Each data per satellite will be loaded separately with an appropriate name.</p>
<p>Each of the following lines starting with “file” define the path to the nc-file. Each second line reads the defined file with the xarray function “open_dataset”. and reads the nc-file into an xarray-dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">file</span> <span class="o">=</span> <span class="n">datadir</span> <span class="o">+</span> <span class="s1">&#39;Data/download_uth_noaa18.nc&#39;</span>
<span class="n">dataset_noaa18</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="n">file</span> <span class="o">=</span> <span class="n">datadir</span> <span class="o">+</span> <span class="s1">&#39;Data/download_uth_metopa.nc&#39;</span>
<span class="n">dataset_metopa</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Please find below the xarray dataset of the MetOp-A satellite exemplary:</p>
<p>It provides information about the:</p>
<ul class="simple">
<li><p>Dimensions: Lat and Lon with 1° resolution and a lenght of 180/360 and 4315 days</p></li>
<li><p>Coordinates: Spatial coordinates for Latitude and Longitude, temporal coordinates for time</p></li>
<li><p>Data variables: List of variable(s) (in our case “uth_mean_ascend_descend” is relevant)</p></li>
<li><p>Attributes: Various important information about the dataset</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataset_metopa</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                  (lon: 360, lat: 180, time: 4315)
Coordinates:
  * lon                      (lon) float64 -179.5 -178.5 -177.5 ... 178.5 179.5
  * lat                      (lat) float64 -89.5 -88.5 -87.5 ... 87.5 88.5 89.5
  * time                     (time) datetime64[ns] 2007-01-01 ... 2018-12-31
Data variables:
    uth_mean_ascend_descend  (time, lat, lon) float32 ...
Attributes: (12/31)
    title:                      Upper Tropospheric Humidity (UTH) based on mi...
    id:                         DOI:10.5676/EUM_SAF_CM/UTH/V001
    product_version:            1.0
    creator_name:               UK/MOD/MET/HADLEY
    creator_email:              contact.cmsaf@dwd.de
    creator_url:                www.cmsaf.eu
    ...                         ...
    summary:                    The upper tropospheric humidity (UTH) channel...
    keywords:                   EARTH SCIENCE &gt; ATMOSPHERE &gt; ATMOSPHERIC WATE...
    history:                     
    platform:                   METOP-A &gt; Meteorological Operational Satellit...
    license:                    All intellectual property rights of the CM SA...
    source:                     SATELLITE-UTH</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a04e0d0a-9acb-4aa2-ad32-49ca2656a703' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a04e0d0a-9acb-4aa2-ad32-49ca2656a703' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lon</span>: 360</li><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>time</span>: 4315</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-7f1c16ee-e20a-4c30-b40c-a1a795764da8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7f1c16ee-e20a-4c30-b40c-a1a795764da8' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-179.5 -178.5 ... 178.5 179.5</div><input id='attrs-7b3e9a48-a728-43d1-b646-964f8249bdde' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7b3e9a48-a728-43d1-b646-964f8249bdde' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-06ede585-d66c-4d59-a66e-1fb38afb3c4d' class='xr-var-data-in' type='checkbox'><label for='data-06ede585-d66c-4d59-a66e-1fb38afb3c4d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_range :</span></dt><dd>[  0. 360.]</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd>360.0</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd></dl></div><div class='xr-var-data'><pre>array([-179.5, -178.5, -177.5, ...,  177.5,  178.5,  179.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-25b8780a-e920-49ac-9bd0-50713c2a2ed7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-25b8780a-e920-49ac-9bd0-50713c2a2ed7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a7600bfb-4314-4583-99ec-764a50475ddd' class='xr-var-data-in' type='checkbox'><label for='data-a7600bfb-4314-4583-99ec-764a50475ddd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_range :</span></dt><dd>[-90.  90.]</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd>90.0</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
       -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
       -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
       -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
       -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
       -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
       -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
        30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
        40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
        50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
        60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
        70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2007-01-01 ... 2018-12-31</div><input id='attrs-a55875fa-6510-4b35-a3eb-bc1aa1293080' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a55875fa-6510-4b35-a3eb-bc1aa1293080' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-75bf6942-91b6-4168-b90c-e2aa0f14afdb' class='xr-var-data-in' type='checkbox'><label for='data-75bf6942-91b6-4168-b90c-e2aa0f14afdb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>valid_range :</span></dt><dd>[         0 2147483647]</dd><dt><span>axis :</span></dt><dd>T</dd><dt><span>stored_direction :</span></dt><dd>increasing</dd><dt><span>type :</span></dt><dd>double</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2007-01-01T00:00:00.000000000&#x27;, &#x27;2007-01-02T00:00:00.000000000&#x27;,
       &#x27;2007-01-03T00:00:00.000000000&#x27;, ..., &#x27;2018-12-29T00:00:00.000000000&#x27;,
       &#x27;2018-12-30T00:00:00.000000000&#x27;, &#x27;2018-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a11a522c-db80-40e1-9d8c-b66957174e57' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a11a522c-db80-40e1-9d8c-b66957174e57' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>uth_mean_ascend_descend</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-e1c3f4cd-5505-4613-b20f-4844f988c7cb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e1c3f4cd-5505-4613-b20f-4844f988c7cb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-174464a5-ce45-4651-ad7c-5261f24844db' class='xr-var-data-in' type='checkbox'><label for='data-174464a5-ce45-4651-ad7c-5261f24844db' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>UTH mean ascending and descending passes</dd><dt><span>units :</span></dt><dd>%</dd><dt><span>valid_range :</span></dt><dd>[  0. 100.]</dd><dt><span>standard_name :</span></dt><dd>relative_humidity</dd><dt><span>comment :</span></dt><dd>The relative humidity with respect to liquid water for T&gt; 0 C, and with respect to ice for T&lt;0 C.</dd><dt><span>cds_magics_style_name :</span></dt><dd>turbo_0_100</dd><dt><span>type :</span></dt><dd>real</dd></dl></div><div class='xr-var-data'><pre>[279612000 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e1e56330-1611-40d1-8a2a-d40c4d6b1663' class='xr-section-summary-in' type='checkbox'  ><label for='section-e1e56330-1611-40d1-8a2a-d40c4d6b1663' class='xr-section-summary' >Attributes: <span>(31)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>Upper Tropospheric Humidity (UTH) based on microwave sounders observations developed by Met Office Hadley Centre, UK on behalf of EUMETSAT Climate Monitoring Satellite Applications Facility (CM SAF).</dd><dt><span>id :</span></dt><dd>DOI:10.5676/EUM_SAF_CM/UTH/V001</dd><dt><span>product_version :</span></dt><dd>1.0</dd><dt><span>creator_name :</span></dt><dd>UK/MOD/MET/HADLEY</dd><dt><span>creator_email :</span></dt><dd>contact.cmsaf@dwd.de</dd><dt><span>creator_url :</span></dt><dd>www.cmsaf.eu</dd><dt><span>institution :</span></dt><dd>EUMETSAT/CMSAF</dd><dt><span>project :</span></dt><dd>Satellite Application Facility on Climate Monitoring (CM SAF)</dd><dt><span>references :</span></dt><dd>http://dx.doi.org/10.5676/EUM_SAF_CM/UTH/V001</dd><dt><span>Conventions :</span></dt><dd>CF-1.6,ACDD-1.3</dd><dt><span>keywords_vocabulary :</span></dt><dd>GCMD Science Keywords, Version 8.1</dd><dt><span>standard_name_vocabulary :</span></dt><dd>Standard Name Table (v28, 07 January 2015)</dd><dt><span>geospatial_lat_units :</span></dt><dd>degree_north</dd><dt><span>geospatial_lat_min :</span></dt><dd>-89.5</dd><dt><span>geospatial_lat_max :</span></dt><dd>89.5</dd><dt><span>geospatial_lon_units :</span></dt><dd>degree_east</dd><dt><span>geospatial_lon_min :</span></dt><dd>0.5</dd><dt><span>geospatial_lon_max :</span></dt><dd>359.5</dd><dt><span>geospatial_lat_resolution :</span></dt><dd>1.0 degree</dd><dt><span>geospatial_lon_resolution :</span></dt><dd>1.0 degree</dd><dt><span>time_coverage_resolution :</span></dt><dd>P1D</dd><dt><span>platform_vocabulary :</span></dt><dd>GCMD Platforms, Version 8.5</dd><dt><span>instrument :</span></dt><dd>MHS &gt; Microwave Humidity Sounder</dd><dt><span>instrument_vocabulary :</span></dt><dd>GCMD Instruments, Version 8.5</dd><dt><span>date_created :</span></dt><dd>2018-04-11T19:57:59Z</dd><dt><span>summary :</span></dt><dd>The upper tropospheric humidity (UTH) channel is the one located at 183.31+/-1.00 GHz of AMSU-B and MHS instruments. The current data record extends from 1999 to 2015 and it is available to the community for climate studies. The main advantage of microwave based UTH in comparison to retrievals from infrared instruments is that the impact of clouds is significantly lower, which is turn offers better coverage of the Earth.</dd><dt><span>keywords :</span></dt><dd>EARTH SCIENCE &gt; ATMOSPHERE &gt; ATMOSPHERIC WATER VAPOR</dd><dt><span>history :</span></dt><dd> </dd><dt><span>platform :</span></dt><dd>METOP-A &gt; Meteorological Operational Satellite - A</dd><dt><span>license :</span></dt><dd>All intellectual property rights of the CM SAF products belong to EUMETSAT. 
  The use of these products is granted to every interested user, free of charge. If you wish to use these products, EUMETSAT&#x27;s copyright credit must be shown by displaying the words copyright (year) EUMETSAT on each of the products used. 
 The CM SAF data are owned by EUMETSAT and are available to all users free of charge and with no conditions to use. If you wish to use these products, EUMETSAT&#x27;s copyright credit must be shown by displaying the words Copyright (c) ([release-year]) EUMETSAT under/in each of these SAF Products used in a project or shown in a publication or website. 
 Please follow the citation guidelines given at http://dx.doi.org/10.5676/EUM_SAF_CM/UTH/V001 and also register as a user at  http://cm-saf.eumetsat.int to receive latest information on CM SAF services and to get access to the CM SAF User Help Desk.</dd><dt><span>source :</span></dt><dd>SATELLITE-UTH</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>In advance of the following processing and visualisation part we set a directory where to save the figures. The folder <strong>Figures</strong> was created manually beforehand in the <strong>datadir</strong> directory and the path is defined as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figpath</span> <span class="o">=</span> <span class="n">datadir</span> <span class="o">+</span> <span class="s1">&#39;Figures/&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="uth-variation-and-climatology-over-europe">
<h2>3. UTH variation and climatology over Europe<a class="headerlink" href="#uth-variation-and-climatology-over-europe" title="Link to this heading">#</a></h2>
<p>Use Case #1 aims to give a general overview about the distribution of Upper Tropospheric Humidity over Europe. We will calculate and plot a temporal mean (map plot) as well as a spatial-averaged climatology (time series).</p>
<section id="calculation-of-temporal-mean-over-europe">
<h3>Calculation of temporal mean over Europe<a class="headerlink" href="#calculation-of-temporal-mean-over-europe" title="Link to this heading">#</a></h3>
<p>In a first step of processing we reduce the amount of data by defining european borders and cutting the data to 30°-76°N and -25°-45°E. The function <strong>.where</strong> only considers what meets the requirements defined inside the brackets. <strong>&amp;</strong> means only gridpoints are considered which meet <strong>every</strong> criteria successfully (four criteria in this case).</p>
<p>In a second step we calculate the temporal average with the function <strong>np.nanmean</strong>. <strong>np</strong> is short for numpy and a library for mathmatical working with arrays. <strong>nanmean</strong> averages the data and ignores nan’s. nan is short for <strong>Not A Number</strong> and is common in satellite meteorology. Since the retrieval methods are highly complex, satellites occasionally fail to provide data, gaps in data sets occur, the zenith angle of the sun must be taken into account or difficulties arise in detecting snow/ice and clouds, it can happen that certain time steps and grid cells don’t have any values. These are set to nan.</p>
<p>This operation is applied to the cut dataset_uth_noaa18_europe and dataset_uth_metopa_europe and the variable “uth_mean_ascend_descend”. <strong>axis=0</strong> means averaged over the first axis, which is “time” in this case. This leads to a 2D dataset (lat and lon) and “removes” the time dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cut data with &quot;.where&quot;-option applied on both arrays. Only gridpoints are considered in between</span>
<span class="c1"># the given latitudes/longitudes. The outside is &quot;dropped&quot;.</span>
<span class="n">dataset_noaa18_europe</span> <span class="o">=</span> <span class="n">dataset_noaa18</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">dataset_noaa18</span><span class="o">.</span><span class="n">lat</span> <span class="o">&gt;</span> <span class="mi">29</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataset_noaa18</span><span class="o">.</span><span class="n">lat</span> <span class="o">&lt;</span> <span class="mi">77</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">dataset_noaa18</span><span class="o">.</span><span class="n">lon</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">26</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataset_noaa18</span><span class="o">.</span><span class="n">lon</span> <span class="o">&lt;</span> <span class="mi">46</span><span class="p">),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">dataset_metopa_europe</span> <span class="o">=</span> <span class="n">dataset_metopa</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">dataset_metopa</span><span class="o">.</span><span class="n">lat</span> <span class="o">&gt;</span> <span class="mi">29</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataset_metopa</span><span class="o">.</span><span class="n">lat</span> <span class="o">&lt;</span> <span class="mi">77</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">dataset_metopa</span><span class="o">.</span><span class="n">lon</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">26</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">dataset_metopa</span><span class="o">.</span><span class="n">lon</span> <span class="o">&lt;</span> <span class="mi">46</span><span class="p">),</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Calculate temporal average</span>
<span class="n">average_noaa18_europe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">dataset_noaa18_europe</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">average_metopa_europe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">dataset_metopa_europe</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Here we get the longitude and latitude coordinates. We will need them in the following plotting commands. Both are coordinates of the dataset and available with the <strong>.variables[‘lon/lat’]</strong> function applied on the dataset.</p>
<p>[:] usually means [from:till], but without numbers it means “everything”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lon_europe</span> <span class="o">=</span> <span class="n">dataset_noaa18_europe</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][:]</span>
<span class="n">lat_europe</span> <span class="o">=</span> <span class="n">dataset_noaa18_europe</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">][:]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-of-temporal-mean-over-europe">
<h3>Plot of temporal mean over Europe<a class="headerlink" href="#plot-of-temporal-mean-over-europe" title="Link to this heading">#</a></h3>
<p>With the calculation done the data is ready for a plot. Please find as follows the plot and settings.</p>
<p>Since we want to make two plots we take advantage of a loop and prepare lists to run through. The following <strong>datasets</strong> and <strong>titles</strong> are lists each containing two entries. The upcoming loop will access to these lists and grab the entries in each run respectively.</p>
<p>A loop in general helps to summarize processes which want to be executed multiple times. Instead of writing everything down, a loop can be defined which runs a process a certain number of times with slightly defined differences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">average_noaa18_europe</span><span class="p">,</span> <span class="n">average_metopa_europe</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NOAA-18&#39;</span><span class="p">,</span> <span class="s1">&#39;MetOp-A&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We use &quot;subplots&quot; to place multiple plots according our needs. In this case we want 2 plots</span>
<span class="c1"># alongside in one row.</span>

<span class="c1"># For this we define &quot;nrows&quot; = 1 and &quot;ncols&quot; = 2, the projection and size is defined as well</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                       <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># We run the same routine twice with different dataset and title (see above)</span>
<span class="c1"># Note: All indented lines are passed through by the loop until a line is not indented, so make</span>
<span class="c1"># sure emtpy lines are indented as well.</span>
<span class="c1"># At the first run i=0, at the second run i=1 and based on this the indecees of both lists</span>
<span class="c1"># (see above) are considered</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    
    <span class="c1"># Plot data (coordinates and data) and define colormap, minimum and maximum values</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_europe</span><span class="p">,</span> <span class="n">lat_europe</span><span class="p">,</span> <span class="n">datasets</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    
    <span class="c1"># Set title and size</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;UTH variation derived by MHS on &#39;</span> <span class="o">+</span> <span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    
    <span class="c1"># Add coastlines and country borders to the map</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">)</span>
    
    <span class="c1"># Restrict plot area to Europe</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">74</span><span class="p">])</span>
    
    <span class="c1"># Define grid lines and ticks (e.g. from -25 to 46 in an interval of 10)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LongitudeFormatter</span><span class="p">()</span>
    <span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LatitudeFormatter</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Place the subplots</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Define and place a horizontal colorbar at the bottom</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Mean daily UTH (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Define an overall title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;UTH variation over Europe from 2007-2018&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Save figure to defined folder</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figpath</span> <span class="o">+</span> <span class="s1">&#39;UTH_Europe_map.png&#39;</span><span class="p">)</span>

<span class="c1"># Show plot and close it afterwards to reduce the amount of storage</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1bc88b590776a1a1747f96d096749ad6ae9e8dd5b9d7b58e526bed56be2f81b7.png" src="../_images/1bc88b590776a1a1747f96d096749ad6ae9e8dd5b9d7b58e526bed56be2f81b7.png" />
</div>
</div>
<p>Figure 3 shows the temporal mean of the daily UTH over Europe, between 25°W to 45°E longitude and 30°N to 74°N latitude, derived from NOAA-18 MHS (left) and MetOp-A MHS (right) from 2007 to 2018.</p>
<p>The main feature illustrated by both plots is the general north-south gradient of the UTH. The relatively dry Mediterranean regions have been significantly influenced by the descending branch of the Hadley Cell. The cool, dry air warms adiabatically as it descends, causing reduction in relative humidity and UTH. One can see that both plots look very similar and the data are very well comparable.</p>
</section>
<section id="calculation-of-climatology-over-europe">
<h3>Calculation of climatology over Europe<a class="headerlink" href="#calculation-of-climatology-over-europe" title="Link to this heading">#</a></h3>
<p>In a next step we want to plot a time series of both datasets. A spatial average is required which isn’t as trivial to calculate as it sounds. The area of a grid cell depends on the latitude with greater areas per grid cell towards the equator (as you can imagine 1/360 of the circumference of the earth is higher at the equator with the maximum perimeter to find there). In case every grid cell would be treated with the same weighting it would result in an overestimation of the grid cells towards the high latitudes. This is because all grid cells (1°x1°) in the dataset are weighted the same by now. Since the grid cells are defined by the latitudes and longitudes the areas are in real not equal in size and need to be multiplied by a factor. This is called cosine-weighted-averaging, since the cosine of the latitude is maximum at the equator (0° with cos(0°) = 1) and becomes smaller towards high latitudes (90° with cos(90°) = 0). This represents the ratio of the grid cells in terms of size with <em>too big areas</em> towards high latitudes multiplied accordingly with a smaller number.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the weightning-factors for each latitude with the functions np.cos and np.deg2rad</span>
<span class="c1"># The latitudes are provided by the variable of the dataset_noaa18 dataset (dataset_noaa18.lat)</span>
<span class="c1"># The function np.deg2rad converts the values from &quot;degree&quot; to &quot;radiances&quot; and np.cos calculates the</span>
<span class="c1"># cosine of these values</span>
<span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">dataset_noaa18</span><span class="o">.</span><span class="n">lat</span><span class="p">))</span>

<span class="c1"># The array &quot;weights&quot; is named &quot;weights&quot; and has 180 values</span>
<span class="c1"># [0.00872654 ... 99996192 ... 0.00872654] for [-89.5° ... 0.5° ... 89.5°]</span>
<span class="n">weights</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;weights&quot;</span>

<span class="c1"># The datasets and respective variable are weighted (.weighted) with the array &quot;weights&quot;</span>
<span class="n">weighted_data</span> <span class="o">=</span> <span class="n">dataset_noaa18_europe</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="c1"># The previously created dataset &quot;weighted_data&quot; is averaged spatially (.mean((&quot;lon&quot;, &quot;lat&quot;))) and</span>
<span class="c1"># nan&#39;s skipped</span>
<span class="n">data_noaa18_europe</span> <span class="o">=</span> <span class="n">weighted_data</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">weighted_data</span> <span class="o">=</span> <span class="n">dataset_metopa_europe</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">data_metopa_europe</span> <span class="o">=</span> <span class="n">weighted_data</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Get time values to plot the climatology. One fact that should not be neglected working with satellite data is gaps. The generation of satellite data is highly complex and instruments fail from time to time leading to gaps for certain days or months. To be save and visualizing correct data we take the dates from the dataset itself instead of creating an own time vector.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This operation gives us the &quot;values&quot; of the &quot;time&quot; dimension</span>
<span class="n">time_noaa18</span> <span class="o">=</span> <span class="n">dataset_noaa18_europe</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span>
<span class="n">time_metopa</span> <span class="o">=</span> <span class="n">dataset_metopa_europe</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-of-climatology-over-europe">
<h3>Plot of climatology over Europe<a class="headerlink" href="#plot-of-climatology-over-europe" title="Link to this heading">#</a></h3>
<p>This time we will plot a time series with different commands. To make the data comparable both time series are put together in one plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create figure and define size</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="c1"># Plot data for NOAA-18 and MetOp-A and adjust color, label and linewidth</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_noaa18</span><span class="p">,</span> <span class="n">data_noaa18_europe</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MHS on NOAA-18&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_metopa</span><span class="p">,</span> <span class="n">data_metopa_europe</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MHS on MetOp-A&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Add legend and place it to the top right</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Add x- and y-axis label and size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean daily UTH (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Add limits of y-axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>

<span class="c1"># Add ticks and background grid</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Save figure to defined folder</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figpath</span> <span class="o">+</span> <span class="s1">&#39;UTH_Europe_climatology.png&#39;</span><span class="p">)</span>

<span class="c1"># Show plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5e7d9c05b79f87edfa1ae491c463aea1f3e775ed0d74a305cdb4f531aeaa2a43.png" src="../_images/5e7d9c05b79f87edfa1ae491c463aea1f3e775ed0d74a305cdb4f531aeaa2a43.png" />
</div>
</div>
<p>Figure 4 shows the time series of mean daily UTH over Europe from NOAA-18 MHS (blue) and MetOp-A MHS (orange).</p>
<p>An annual variation of UTH is evident from the time series, which shows the spatial mean of the MHS derived UTH over the same European region as shown in Figure 3 for each satellite. The overall UTH decreases during summer, reaching area averaged values of 30-35%, as the Hadley cell moves north and has a greater impact over the region before retreating south again in winter. Note also the close agreement between the UTH derived from each satellite throughout the time period.</p>
<p>Outlook after Use Case #1: We did the analysis for a certain time period, certain satellites and a certain region and provided a maps as well as a time series. It is now up to you to either continue with the next use case or try adjust the code for different regions, time periods … This might be a good way to gain also programming skills to detect the parts of the code which needs be changed. Please watch out for the naming of files, arrays and plots to keep track and a clear structure in your folders!</p>
</section>
</section>
<section id="global-uth-distribution-seasonal-variation-and-annual-cycle">
<h2>4. Global UTH distribution, seasonal variation and annual cycle<a class="headerlink" href="#global-uth-distribution-seasonal-variation-and-annual-cycle" title="Link to this heading">#</a></h2>
<p>Use Case #2 has global coverage and provides information on the distribution of UTH across the planet. However, we do not have to download the data again, but take advantage of the fact that we have already downloaded and read it earlier. Use Case #2 provides additional information about the seasonal variation as well as the annual cycle.
Starting points are the xarray datasets <strong>dataset_noaa18</strong> and <strong>dataset_metopa</strong> from above but without any restrictions concerning only Europe.</p>
<section id="calculation-of-temporal-mean-with-global-coverage">
<h3>4.1 Calculation of temporal mean with global coverage<a class="headerlink" href="#calculation-of-temporal-mean-with-global-coverage" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate temporal average</span>
<span class="c1"># Once again the function nanmean calculates the average ignoring nan&#39;s, axis=0 averages over the</span>
<span class="c1"># time dimension</span>
<span class="n">average_noaa18</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">dataset_noaa18</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">average_metopa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">dataset_metopa</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Get longitude and latitude coordinates. Both are variables of the dataset and available with the</span>
<span class="c1"># .variables[&#39;lat/lon&#39;] function, [:] usually means [&quot;from&quot;:&quot;till&quot;] but without numbers it means</span>
<span class="c1"># &quot;everything&quot;</span>
<span class="n">lon_global</span> <span class="o">=</span> <span class="n">dataset_noaa18</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">][:]</span>
<span class="n">lat_global</span> <span class="o">=</span> <span class="n">dataset_noaa18</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">][:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_17482/2268510229.py:4: RuntimeWarning: Mean of empty slice
  average_noaa18 = np.nanmean(dataset_noaa18[&#39;uth_mean_ascend_descend&#39;], axis=0)
/tmp/ipykernel_17482/2268510229.py:5: RuntimeWarning: Mean of empty slice
  average_metopa = np.nanmean(dataset_metopa[&#39;uth_mean_ascend_descend&#39;], axis=0)
</pre></div>
</div>
</div>
</div>
<p>You just might noticed a so-called <strong>RuntimeWarning: Mean of empty slice</strong> with the above command. This is correct and easy to explain: Since the command calculates the temporal average it calculates the average for each grid cell over all time steps. In case there is a grid cell with nan’s for all days it results in a warning to calculate a “mean of an empty slice”. This grid cell will also be marked as nan and can be seen in the following plot e.g. 80°S and 90°E.</p>
<p>Again we are plotting two maps and take advantage of a loop and prepare lists to run through:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">average_noaa18</span><span class="p">,</span> <span class="n">average_metopa</span><span class="p">]</span>
<span class="n">titles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NOAA-18&#39;</span><span class="p">,</span> <span class="s1">&#39;MetOp-A&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-of-temporal-mean-with-global-coverage">
<h3>4.2 Plot of temporal mean with global coverage<a class="headerlink" href="#plot-of-temporal-mean-with-global-coverage" title="Link to this heading">#</a></h3>
<p>The plotting routine is pretty much the same like Figure 3 with small adjustments concerning latitude and longitude:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We use &quot;subplots&quot; to place multiple plots according our needs. In this case we want 2 plots</span>
<span class="c1"># alongside in a row.</span>

<span class="c1"># For this we define &quot;nrows&quot; = 1 and &quot;ncols&quot; = 2, the projection and size is defined as well</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                       <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># We run the same routine twice with different datasets and titles (see above)</span>
<span class="c1"># Note: All indented lines are passed through by the loop until a line is not indented, so make</span>
<span class="c1"># sure emtpy lines are indented as well.</span>
<span class="c1"># At the first run i=0, at the second run i=1 and based on this the indecees of both lists</span>
<span class="c1"># (see above) are considered</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    
    <span class="c1"># Plot data (coordinates and data) and define colormap, minimum and maximum values</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_global</span><span class="p">,</span> <span class="n">lat_global</span><span class="p">,</span> <span class="n">datasets</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
    
    <span class="c1"># Set title and size</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;UTH variation derived by MHS on &#39;</span> <span class="o">+</span> <span class="n">titles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    
    <span class="c1"># Add coastlines</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
    
    <span class="c1"># Define grid lines and ticks (e.g. from -180 to 180 in a interval of 60)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LongitudeFormatter</span><span class="p">()</span>
    <span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LatitudeFormatter</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Place the subplots</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">1.40</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Define and place a colorbar at the bottom</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Mean daily UTH (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Define an overall title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Global UTH variation from 2007-2018&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Save figure to defined folder</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figpath</span> <span class="o">+</span> <span class="s1">&#39;UTH_global_map.png&#39;</span><span class="p">)</span>

<span class="c1"># Show plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">5</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># We use &quot;subplots&quot; to place multiple plots according our needs. In this case we want 2 plots</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="c1"># alongside in a row.</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># For this we define &quot;nrows&quot; = 1 and &quot;ncols&quot; = 2, the projection and size is defined as well</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>                        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="c1"># We run the same routine twice with different datasets and titles (see above)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="c1"># Note: All indented lines are passed through by the loop until a line is not indented, so make</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="c1"># sure emtpy lines are indented as well.</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="c1"># At the first run i=0, at the second run i=1 and based on this the indecees of both lists</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="c1"># (see above) are considered</span>
<span class="g g-Whitespace">     </span><span class="mi">13</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span>     
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="c1"># Plot data (coordinates and data) and define colormap, minimum and maximum values</span>

<span class="ne">NameError</span>: name &#39;plt&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Figure 5 shows the temporal mean of the daily UTH from 2007-2018 with global coverage. With a few exceptions there is still a gradient from the equator towards the poles with higher values towards higher latitudes. One exception can be seen right around the equator with much higher values, in particular northwest of Australia but also parts of South America and Africa. But we will address this later …</p>
</section>
<section id="calculation-of-seasonal-average-with-global-coverage">
<h3>4.3 Calculation of seasonal average with global coverage<a class="headerlink" href="#calculation-of-seasonal-average-with-global-coverage" title="Link to this heading">#</a></h3>
<p>In a further analysis we want to split the data according to the seasons. This will be only done for the NOAA-18 data since it is suffiently shown that the data of different satellites differs only slightly.
Seasons are defined as follows:
- Spring: March, April, May
- Summer: June, July, August
- Autumn: September, October, November
- Winter: December, January, February</p>
<p>To achieve this we use the <strong>.groupby</strong> function with the addition <strong>time.season</strong>. That means the dataset is splitted into predefined seasons in consideration of the time variable. The addition <strong>.mean(‘time’)</strong> averages the data according to the time dimension to achieve a temporal average.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We cut the dataset in time at the beginning and end to make sure only complete seasons are taken</span>
<span class="c1"># into account. The first season will be Spring 2007, the last is Autumn 2018. With the function</span>
<span class="c1"># .sel (select) we define to reduce the data to a defined range of dates at the time dimension</span>
<span class="n">dataset_noaa18_sel</span> <span class="o">=</span> <span class="n">dataset_noaa18</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2007-02-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2018-11-30&#39;</span><span class="p">))</span>

<span class="c1"># Split dataset by season</span>
<span class="n">seasonal_average</span> <span class="o">=</span> <span class="n">dataset_noaa18_sel</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seasonal_average</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                  (lon: 360, lat: 180, season: 4)
Coordinates:
  * lon                      (lon) float64 -179.5 -178.5 -177.5 ... 178.5 179.5
  * lat                      (lat) float64 -89.5 -88.5 -87.5 ... 87.5 88.5 89.5
  * season                   (season) object &#x27;DJF&#x27; &#x27;JJA&#x27; &#x27;MAM&#x27; &#x27;SON&#x27;
Data variables:
    uth_mean_ascend_descend  (season, lat, lon) float32 75.23 nan ... 62.09 58.1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6c97c3d3-64e9-4abf-8216-4dd0729307d3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6c97c3d3-64e9-4abf-8216-4dd0729307d3' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lon</span>: 360</li><li><span class='xr-has-index'>lat</span>: 180</li><li><span class='xr-has-index'>season</span>: 4</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-551dbf85-284c-4797-8b6a-ea0000036c9b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-551dbf85-284c-4797-8b6a-ea0000036c9b' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-179.5 -178.5 ... 178.5 179.5</div><input id='attrs-bcd44c0f-dfcc-47e0-aa06-449a12aa180d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bcd44c0f-dfcc-47e0-aa06-449a12aa180d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e8c38c4-fc9d-4979-b5c0-4c104042bce6' class='xr-var-data-in' type='checkbox'><label for='data-0e8c38c4-fc9d-4979-b5c0-4c104042bce6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>valid_range :</span></dt><dd>[  0. 360.]</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd>360.0</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd></dl></div><div class='xr-var-data'><pre>array([-179.5, -178.5, -177.5, ...,  177.5,  178.5,  179.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.5 -88.5 -87.5 ... 88.5 89.5</div><input id='attrs-d3d36d73-b10a-4d7f-a564-21296a5153b7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d3d36d73-b10a-4d7f-a564-21296a5153b7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aaf41610-5079-4ead-a7bb-720f4c210ab5' class='xr-var-data-in' type='checkbox'><label for='data-aaf41610-5079-4ead-a7bb-720f4c210ab5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>valid_range :</span></dt><dd>[-90.  90.]</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd>90.0</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd></dl></div><div class='xr-var-data'><pre>array([-89.5, -88.5, -87.5, -86.5, -85.5, -84.5, -83.5, -82.5, -81.5, -80.5,
       -79.5, -78.5, -77.5, -76.5, -75.5, -74.5, -73.5, -72.5, -71.5, -70.5,
       -69.5, -68.5, -67.5, -66.5, -65.5, -64.5, -63.5, -62.5, -61.5, -60.5,
       -59.5, -58.5, -57.5, -56.5, -55.5, -54.5, -53.5, -52.5, -51.5, -50.5,
       -49.5, -48.5, -47.5, -46.5, -45.5, -44.5, -43.5, -42.5, -41.5, -40.5,
       -39.5, -38.5, -37.5, -36.5, -35.5, -34.5, -33.5, -32.5, -31.5, -30.5,
       -29.5, -28.5, -27.5, -26.5, -25.5, -24.5, -23.5, -22.5, -21.5, -20.5,
       -19.5, -18.5, -17.5, -16.5, -15.5, -14.5, -13.5, -12.5, -11.5, -10.5,
        -9.5,  -8.5,  -7.5,  -6.5,  -5.5,  -4.5,  -3.5,  -2.5,  -1.5,  -0.5,
         0.5,   1.5,   2.5,   3.5,   4.5,   5.5,   6.5,   7.5,   8.5,   9.5,
        10.5,  11.5,  12.5,  13.5,  14.5,  15.5,  16.5,  17.5,  18.5,  19.5,
        20.5,  21.5,  22.5,  23.5,  24.5,  25.5,  26.5,  27.5,  28.5,  29.5,
        30.5,  31.5,  32.5,  33.5,  34.5,  35.5,  36.5,  37.5,  38.5,  39.5,
        40.5,  41.5,  42.5,  43.5,  44.5,  45.5,  46.5,  47.5,  48.5,  49.5,
        50.5,  51.5,  52.5,  53.5,  54.5,  55.5,  56.5,  57.5,  58.5,  59.5,
        60.5,  61.5,  62.5,  63.5,  64.5,  65.5,  66.5,  67.5,  68.5,  69.5,
        70.5,  71.5,  72.5,  73.5,  74.5,  75.5,  76.5,  77.5,  78.5,  79.5,
        80.5,  81.5,  82.5,  83.5,  84.5,  85.5,  86.5,  87.5,  88.5,  89.5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>season</span></div><div class='xr-var-dims'>(season)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;DJF&#x27; &#x27;JJA&#x27; &#x27;MAM&#x27; &#x27;SON&#x27;</div><input id='attrs-72cfd18f-73ae-4e8d-b7ec-fd00f6ecbdb3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-72cfd18f-73ae-4e8d-b7ec-fd00f6ecbdb3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb6f5bf6-a1cb-4f17-a434-f0721b9ce6be' class='xr-var-data-in' type='checkbox'><label for='data-eb6f5bf6-a1cb-4f17-a434-f0721b9ce6be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;DJF&#x27;, &#x27;JJA&#x27;, &#x27;MAM&#x27;, &#x27;SON&#x27;], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1ad7c017-1fa3-4d5d-b048-0db818f99b97' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1ad7c017-1fa3-4d5d-b048-0db818f99b97' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>uth_mean_ascend_descend</span></div><div class='xr-var-dims'>(season, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>75.23 nan nan ... 61.27 62.09 58.1</div><input id='attrs-28fea3ec-ff9c-4379-80e3-186f284a7669' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-28fea3ec-ff9c-4379-80e3-186f284a7669' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-81fccc4d-343b-4c5b-bcdc-be6cb7d41cee' class='xr-var-data-in' type='checkbox'><label for='data-81fccc4d-343b-4c5b-bcdc-be6cb7d41cee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[75.22881 ,       nan,       nan, ..., 77.66716 , 60.646515,
               nan],
        [74.15184 , 72.35936 , 73.77721 , ..., 71.13583 , 73.7153  ,
         73.02268 ],
        [71.18257 , 71.85759 , 71.21405 , ..., 72.25091 , 71.467026,
         71.18834 ],
        ...,
        [60.099667, 60.574196, 60.552   , ..., 60.365772, 60.63474 ,
         60.339127],
        [61.17176 , 60.936935, 62.49021 , ..., 60.872086, 61.61694 ,
         60.77697 ],
        [59.04361 , 60.191574, 61.93922 , ..., 56.44952 , 63.32126 ,
         56.7598  ]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [      nan,       nan,       nan, ...,       nan,       nan,
               nan],
...
        [56.844955, 57.100567, 56.69074 , ..., 56.811253, 56.633987,
         57.0398  ],
        [57.63357 , 58.354485, 57.920494, ..., 58.18948 , 57.16385 ,
         57.66442 ],
        [56.78963 , 57.965115, 59.12363 , ..., 58.763107, 55.930664,
         57.39788 ]],

       [[      nan,       nan,       nan, ...,       nan,       nan,
               nan],
        [68.97716 , 73.79325 , 77.69229 , ..., 74.612434, 78.44637 ,
         76.83478 ],
        [67.16053 , 68.35357 , 71.61117 , ..., 67.03998 , 68.36257 ,
         68.47615 ],
        ...,
        [61.230694, 61.057144, 61.327713, ..., 61.13584 , 61.264153,
         61.22891 ],
        [62.65867 , 62.164425, 62.189575, ..., 63.01434 , 62.364887,
         63.29162 ],
        [58.845135, 61.993134, 62.026142, ..., 61.266838, 62.09051 ,
         58.100044]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-30d99643-80d7-460a-9dd2-16e45e3a4d34' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-30d99643-80d7-460a-9dd2-16e45e3a4d34' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>The xarray “seasonal_average” has four entries in the time dimension (one for each season).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the four seasons from the xarray for the variable &quot;uth_mean_ascend_descend&quot; with the</span>
<span class="c1"># respective index [0] - [3]</span>

<span class="n">winter</span> <span class="o">=</span> <span class="n">seasonal_average</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">summer</span> <span class="o">=</span> <span class="n">seasonal_average</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
<span class="n">spring</span> <span class="o">=</span> <span class="n">seasonal_average</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
<span class="n">autumn</span> <span class="o">=</span> <span class="n">seasonal_average</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-of-seasonal-average-with-global-coverage">
<h3>4.4 Plot of seasonal average with global coverage<a class="headerlink" href="#plot-of-seasonal-average-with-global-coverage" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We create a 2x2 matrix in advance of the 2x2 setup of the plots. This helps us to make the plot</span>
<span class="c1"># with 2 loops</span>

<span class="c1"># Creation of an empty 2x2 matrix called &quot;dataset&quot;</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="p">)]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">h</span><span class="p">)]</span>

<span class="c1"># Fill the matrix with the before defined input - e.g. spring will be shown at the top left, winter</span>
<span class="c1"># at the bottom right</span>
<span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">spring</span>
<span class="n">dataset</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">summer</span>
<span class="n">dataset</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">autumn</span>
<span class="n">dataset</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">winter</span>

<span class="c1"># Steps will be repeated for the plots titles</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">w</span><span class="p">)]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">h</span><span class="p">)]</span>
<span class="n">title</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Spring&#39;</span>
<span class="n">title</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Summer&#39;</span>
<span class="n">title</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Autumn&#39;</span>
<span class="n">title</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Winter&#39;</span>

<span class="c1"># We use the &quot;subplots&quot; to place multiple plots according to our needs. In this case we want 4 plots</span>
<span class="c1"># in a 2x2 format. For this &quot;nrows&quot; = 2 and &quot;ncols&quot; = 2, the projection and size is defined as well</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()},</span>
                       <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># We run the same routine twice with different datasets and titles (see above)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        
        <span class="c1"># Plot data (coordinates and data) and define colormap, minimum and maximum values</span>
        <span class="n">cs</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon_global</span><span class="p">,</span> <span class="n">lat_global</span><span class="p">,</span> <span class="n">dataset</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                 <span class="n">vmax</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
        
        <span class="c1"># Set title and size</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;UTH variation derived by MHS on NOAA-18 - &#39;</span> <span class="o">+</span> <span class="n">title</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        
        <span class="c1"># Add coastlines</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
        
        <span class="c1"># Define grid lines and ticks (e.g. from -180 to 180 in a interval of 60)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">60</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">lon_formatter</span> <span class="o">=</span> <span class="n">LongitudeFormatter</span><span class="p">()</span>
        <span class="n">lat_formatter</span> <span class="o">=</span> <span class="n">LatitudeFormatter</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lon_formatter</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">lat_formatter</span><span class="p">)</span>
        <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Place the subplots</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># Define and place a colorbar at the bottom</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Mean daily UTH (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Define an overall title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Seasonal UTH variation from 2007-2018&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># Save figure to defined folder</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figpath</span> <span class="o">+</span> <span class="s1">&#39;UTH_season_map.png&#39;</span><span class="p">)</span>

<span class="c1"># Show plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/836e563c1b18aea5d32c1aada4d414aaa9112f110fdd054bb3546f2162fe1c08.png" src="../_images/836e563c1b18aea5d32c1aada4d414aaa9112f110fdd054bb3546f2162fe1c08.png" />
</div>
</div>
<p>Figure 6 shows the seasonal averages for Spring to Winter (top left to bottom right) derived from NOAA-18 MHS from 2007 to 2018. The general pattern is overall the same with lower values in the tropics around the equator and higher values towards high latitudes. Again remarkable is the narrow band of high UTH values around the equator, particular over land and between Asia and Australia. One can see that the band is not constant all year in the same place but moving northwards towards summer and southwards towards winter. This is similar to the course of the Inter-Tropical Convergence Zone (ITCZ) and related to it:</p>
<p>Solar radiation is highest at the highest solar zenith angle, which is in general in the tropics. Since the earth’s orbit around the sun is in a 23,5° angle the hightest solar zenith angle is moving over the course of a year. It is highest to the north in end of June and highest to the south in end of December.</p>
<p>Due to the shortwave radiation and warming of the land/oceans masses warm air rises and cools adiabatically which leads to increased Upper Tropospheric humidity and cloud coverage. This in turn leads to near ground winds from north and south directions towards the ITCZ and rising air masses due to convergence. Cause of the different specific heat capacities of land and ocean this effect is more significant over land, as everyone has surely noticed, land heats up much faster than water.</p>
</section>
<section id="calculation-of-annual-cycle-with-global-coverage">
<h3>4.5 Calculation of annual cycle with global coverage<a class="headerlink" href="#calculation-of-annual-cycle-with-global-coverage" title="Link to this heading">#</a></h3>
<p>In a last step we want to create a mean annual cycle. For this we need to apply the cosine-weighted-averaging (as to all spatial means).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We use again the known method to calculate the weightned average - this time on a global scale</span>
<span class="n">weighted_data</span> <span class="o">=</span> <span class="n">dataset_noaa18</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">data_noaa18</span> <span class="o">=</span> <span class="n">weighted_data</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">weighted_data</span> <span class="o">=</span> <span class="n">dataset_metopa</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="n">data_metopa</span> <span class="o">=</span> <span class="n">weighted_data</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># To split the data by months we use the &quot;.groupby&quot; function with the addition &quot;time.month&quot;.</span>
<span class="c1"># That means the dataset is splitted into months in consideration of the time variable.</span>
<span class="c1"># The addition &quot;.mean(&#39;time&#39;)&quot; averages the data according to the time dimension to achieve an</span>
<span class="c1"># average for each month.</span>
<span class="n">dataset_noaa18</span> <span class="o">=</span> <span class="n">data_noaa18</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">dataset_metopa</span> <span class="o">=</span> <span class="n">data_metopa</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># We use again the known method to calculate the weightned average - this time on a global scale</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">weighted_data</span> <span class="o">=</span> <span class="n">dataset_noaa18</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">data_noaa18</span> <span class="o">=</span> <span class="n">weighted_data</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="s2">&quot;lat&quot;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">weighted_data</span> <span class="o">=</span> <span class="n">dataset_metopa</span><span class="p">[</span><span class="s1">&#39;uth_mean_ascend_descend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;dataset_noaa18&#39; is not defined
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-of-annual-cycle-with-global-coverage">
<h3>4.6 Plot of annual cycle with global coverage<a class="headerlink" href="#plot-of-annual-cycle-with-global-coverage" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creation of a vector containing the months of the year</span>
<span class="n">year</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>

<span class="c1"># Plot of the annual cycle, define the size</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Plot the data against the year, define color, label and linewidth</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">dataset_noaa18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MHS on NOAA-18&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">dataset_metopa</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;MHS on MetOp-A&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Add a legend and define the size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Add x- and y-axis labels and size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Mean monthly UTH (%)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Define y-axis limts</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">37</span><span class="p">)</span>

<span class="c1"># Add ticks on both axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Add background grid</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Save figure to defined folder</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figpath</span> <span class="o">+</span> <span class="s1">&#39;UTH_global_annual_cycle.png&#39;</span><span class="p">)</span>

<span class="c1"># Show plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ff4ab53a1d4e3e9ab3a67e35e1407aae951898157e6b6017b665e7483da66d35.png" src="../_images/ff4ab53a1d4e3e9ab3a67e35e1407aae951898157e6b6017b665e7483da66d35.png" />
</div>
</div>
<p>Figure 7 shows the annual cycle of the UTH from NOAA-18 (blue) and MetOp-A (orange) averaged from 2007-2018. Looking at the scale shows that the overall difference between minimum (July/August) and maximum (April/November) is only in a range of 4%. But there is indeed an annual cycle with lower values in summer months and higher values in winter especially towards spring. Both datasets agree in general with only slight differences in March, April and December.</p>
<p>Outlook after Use Case #2: There were some new features introduced in Use Case 2 with seasonal averages and annual cycles. But there is much more to investigate with the data, so feel free to get experimental and gain more skills on UTH and python!</p>
</section>
</section>
<section id="literature">
<h2>5. Literature<a class="headerlink" href="#literature" title="Link to this heading">#</a></h2>
<p>[1] Easterbrook, D.J.: <br>
Chapter 9 - Greenhouse Gases, Evidence-Based Climate Science (Second Edition) 2016, <br>
Pages 163-173, <a class="reference external" href="https://doi.org/10.1016/B978-0-12-804588-6.00009-4">https://doi.org/10.1016/B978-0-12-804588-6.00009-4</a></p>
<p>[2] Held, Isaac M., Soden, Brian J.: <br>
Water Vapor Feedback and Global Warming, Annual Review of Energy and the Environment 2000 Vol 25,<br>
Pages 441-475, <a class="reference external" href="https://doi.org/10.1146/annurev.energy.25.1.441">https://doi.org/10.1146/annurev.energy.25.1.441</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ecv-notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-access-the-notebook">How to access the notebook</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outline">Outline</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rationale">Rationale</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#retrieve-data">2. Retrieve data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">Import libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-data">Get the data</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#open-noaa-data-with-xarray">Open NOAA data with xarray</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#uth-variation-and-climatology-over-europe">3. UTH variation and climatology over Europe</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-temporal-mean-over-europe">Calculation of temporal mean over Europe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-temporal-mean-over-europe">Plot of temporal mean over Europe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-climatology-over-europe">Calculation of climatology over Europe</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-climatology-over-europe">Plot of climatology over Europe</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-uth-distribution-seasonal-variation-and-annual-cycle">4. Global UTH distribution, seasonal variation and annual cycle</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-temporal-mean-with-global-coverage">4.1 Calculation of temporal mean with global coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-temporal-mean-with-global-coverage">4.2 Plot of temporal mean with global coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-seasonal-average-with-global-coverage">4.3 Calculation of seasonal average with global coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-seasonal-average-with-global-coverage">4.4 Plot of seasonal average with global coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-of-annual-cycle-with-global-coverage">4.5 Calculation of annual cycle with global coverage</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-of-annual-cycle-with-global-coverage">4.6 Plot of annual cycle with global coverage</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#literature">5. Literature</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>