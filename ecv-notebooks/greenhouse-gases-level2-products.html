
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>How to access and use a satellite-derived GHG Level 2 data product using XCO2_EMMA as an example? &#8212; C3S Training</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ecv-notebooks/greenhouse-gases-level2-products';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to access, read and use satellite XCO2 and XCH4 Level 3 data products" href="greenhouse-gases-level3-products.html" />
    <link rel="prev" title="Calculation of global climatology and annual cycles of Cloud Fractional Cover from EUMETSAT’s CM SAF CLARA-A3 dataset" href="cloud-cover-climatology.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/C3S–POS–LINE.png" class="logo__image only-light" alt="C3S Training - Home"/>
    <script>document.write(`<img src="../_static/C3S–POS–LINE.png" class="logo__image only-dark" alt="C3S Training - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Copernicus Climate Change Service (C3S) Data Tutorials
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Climate Data Store (CDS)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cds-tutorial.html">CDS tutorial</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reanalysis Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../reanalysis-climatology.html">Climatology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reanalysis-heatwave.html">Heatwave Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Climate Projections</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../projections-cmip6.html">Climate Projections (CMIP6)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projections-cordex.html">Climate Projections (CORDEX)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Seasonal Forecasts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../sf-anomalies.html">Seasonal Forecast Anomalies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sf-verification.html">Seasonal Forecast Verification</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Climate Indices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ci-windchill.html">Windchill Index Calculation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials using Satellite Observations</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="erb-outgoing-longwave-radiation.html">Outgoing Longwave Radiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="erb-clara-climatology.html">Analysis of the CLARA Earth radiation budget product</a></li>
<li class="toctree-l1"><a class="reference internal" href="erb-ceres-climatology.html">Analysis of the CERES Earth radiation budget product</a></li>
<li class="toctree-l1"><a class="reference internal" href="total-solar-irradiance.html">Total Solar Irradiance</a></li>
<li class="toctree-l1"><a class="reference internal" href="srb-climatology-and-anomaly.html">Surface radiation budget climatologies and anomalies</a></li>
<li class="toctree-l1"><a class="reference internal" href="total-column-water-vapour-combi.html">Exploring Total Column Water Vapour information in the COMBI dataset</a></li>

<li class="toctree-l1"><a class="reference internal" href="tropospheric-humidity-from-radio-occultation.html">Tropospheric humidity estimates from satellite-based radio occultation measurements</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloud-cover-climatology.html">Cloud fractional cover climatology</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Greenhouse Gas Level 2 Products</a></li>
<li class="toctree-l1"><a class="reference internal" href="greenhouse-gases-level3-products.html">How to access, read and use satellite XCO2 and XCH4 Level 3 data products</a></li>


<li class="toctree-l1"><a class="reference internal" href="aerosol-single-sensor-demonstrator.html">Exploring gridded data on Aerosol properties available on C3S</a></li>
<li class="toctree-l1"><a class="reference internal" href="aerosol-multi-sensor-record.html">Visualising a full Climate Data Record of multi-sensor Aerosol data</a></li>


<li class="toctree-l1"><a class="reference internal" href="total-ozone-columns.html">Exploring an ozone product available through the Climate Data Store (CDS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="soil-moisture-anomalies.html"><strong>C3S Soil Moisture Data Access and Anomaly Analysis Notebook</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="lake-water-level.html">Tutorial: Data Access and  Visualisation of Lake Water Level (LWL) timeseries</a></li>




<li class="toctree-l1"><a class="reference internal" href="lake-surface-water-temperature.html">Visualisation of Lake Surface Water Temperature (LSWT) data for a given lake</a></li>




<li class="toctree-l1"><a class="reference internal" href="viewer-for-sealevel-product.html">Looking at Sea Level data during an El Niño episode</a></li>
<li class="toctree-l1"><a class="reference internal" href="ice-sheet-surface-elevation.html">Ice sheet surface elevation change rates</a></li>
<li class="toctree-l1"><a class="reference internal" href="ice-sheet-velocity.html">Access and visualisation of the Greenland Ice Sheet velocity data</a></li>
<li class="toctree-l1"><a class="reference internal" href="ice-sheet-mass-balance.html">Exploring Ice sheet Gravimetric Mass Balance data, available through the C3S Climate Data Store</a></li>




<li class="toctree-l1"><a class="reference internal" href="glacier-area.html">Explore glacier area</a></li>
<li class="toctree-l1"><a class="reference internal" href="glacier-mass-change.html">Glacier mass change</a></li>
<li class="toctree-l1"><a class="reference internal" href="mean-with-inverse-variance-weights.html">Computing the time average of LAI and fAPAR using inverse variance weights</a></li>

<li class="toctree-l1"><a class="reference internal" href="precipitation-giraffe.html">Exploring Precipitation information in the GIRAFE dataset</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Turorials using Copernicus Emergency Management Service data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cems-notebooks/visualising-fwi-for-esotc.html">Visualising fire weather index (FWI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cems-notebooks/glofas-bangladesh-floods.html">Observing major flood events</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials on Bias Correction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://ibicus.readthedocs.io/en/latest/getting_started/overview.html">Python library (ibicus) and tutorials on bias correction</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Atmosphere Monitoring Tutorials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="https://ecmwf-projects.github.io/copernicus-training-cams/">Tutorials from the Copernicus Atmosphere Monitoring Service (CAMS)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/ecmwf-projects/copernicus-training-c3s-review/review?urlpath=tree/ecv-notebooks/greenhouse-gases-level2-products.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ecmwf-projects/copernicus-training-c3s-review" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ecmwf-projects/copernicus-training-c3s-review/issues/new?title=Issue%20on%20page%20%2Fecv-notebooks/greenhouse-gases-level2-products.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/ecv-notebooks/greenhouse-gases-level2-products.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>How to access and use a satellite-derived GHG Level 2 data product using XCO2_EMMA as an example?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-needed-to-use-this-jupyter-notebook">What is needed to use this Jupyter Notebook?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries-used-in-this-tutorial">Import libraries used in this tutorial</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-download-from-cds">Data download from CDS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-some-options-that-are-used-in-this-tutorial">Set some options that are used in this tutorial</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-data-files-with-xarray">Open data files with xarray</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-1-the-latitudinal-distribution-of-xco2">Application 1: The latitudinal distribution of XCO2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-xco2-vs-latitude">Computing XCO2 vs latitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generation-of-xy-plot-showing-xco2-vs-latitude">Generation of xy plot showing XCO2 vs latitude</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-2-showing-daily-data-on-a-map">Application 2: Showing daily data on a map</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><img alt="logo" src="../_images/LogoLine_horizon_C3S.png" /></p>
<section class="tex2jax_ignore mathjax_ignore" id="how-to-access-and-use-a-satellite-derived-ghg-level-2-data-product-using-xco2-emma-as-an-example">
<h1>How to access and use a satellite-derived GHG Level 2 data product using XCO2_EMMA as an example?<a class="headerlink" href="#how-to-access-and-use-a-satellite-derived-ghg-level-2-data-product-using-xco2-emma-as-an-example" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>This is a Jupyter Notebook (JN) illustrating how to access and use a satellite-derived Greenhouse Gas (GHG) atmospheric carbon dioxide (CO2) Level 2 data product as generated via the Copernicus Climate Change Service (C3S) and made available via the Copernicus Climate Data Store <a class="reference external" href="https://cds.climate.copernicus.eu/">CDS</a>.</p>
<p>Here we illustrate the use of a GHG Level 2 (L2) product using product XCO2_EMMA as an example. A CO2 L2 data product contains CO2 information for individual satellite ground pixels (also called footprints or soundings). XCO2 is the column-averaged dry-air mole fraction of atmospheric CO2 in parts per million (ppm). EMMA is the name of the multi-satellite XCO2 (and XCH4) merging algorithm developed to generate product XCO2_EMMA using as input individual Level 2 XCO2 products from different satellite sensors (here: SCIAMACHY/ENVISAT, GOSAT, GOSAT-2 and OCO-2; see, e.g., <a class="reference external" href="https://amt.copernicus.org/articles/13/789/2020/">Reuter et al., 2020</a>).</p>
<p>Within C3S also other L2 products are generated and made available via the CDS. These products are (i) XCO2 from individual satellite sensors, (ii) XCH4 products, where XCH4 is the column-averaged dry-air mole fraction of CH4 in parts per billion (ppb), and (iii) mid tropospheric CO2 and CH4 mixing ratio products. Detailed information on all these products is available via the CDS. In addition to L2 products, also Level 3 (L3) products are available. A L3 product is based on a corresponding L2 product. A L3 product is  obtained by spatio-temporally averaging a corresponding L2 product. How to access and use a L3 GHG product is shown in a separate Jupyter Notebook.</p>
<p>For this JN we use XCO2_EMMA version 4.4, which covers the period 2003 - 2021.</p>
<p>This JN shows how to download a data product from the CDS, explains how to access the main variables and how to use them for a given applications. We focus on two use cases related to the spatial and temporal variation of atmospheric CO2 concentrations and their observational coverage.</p>
<p>The first use case is related to the latitudial distribution of XCO2. We show how XCO2 averages and standard devations per latitude band can be computed and plotted. For this we use two days of observations, one in April and one in September. We explain that the observed latitudinal distributions are closely related to the seasonal cycle of CO2 due to uptake and release of CO2 by vegetation.</p>
<p>For the second use case we show how a map of the spatial distribution of the individual ground pixel XCO2 observations can be generated. We show that the spatial coverage of the daily observations is very sparse due to strict quality filtering of the individual XCO2 retrievals. Most applications therefore require appropriate spatio-temporal averaging (see, for example, the use of C3S GHG XCO2 and XCH4 data for assessments such as Copernicus European State of the Climate (ESOTC) as shown on the <a class="reference external" href="https://climate.copernicus.eu/climate-indicators/greenhouse-gas-concentrations">GHG concentration climate indicators website</a>.</p>
<section id="what-is-needed-to-use-this-jupyter-notebook">
<h3>What is needed to use this Jupyter Notebook?<a class="headerlink" href="#what-is-needed-to-use-this-jupyter-notebook" title="Link to this heading">#</a></h3>
<p>In the following, Python 3 code is provided to read and plot the satellite data.</p>
<p>It is assumed that Python and Jupyter Notebook (JN) is installed on your computer, e.g., using the <a class="reference external" href="https://www.anaconda.com/products/distribution">Anaconda distribution</a>.</p>
</section>
<section id="import-libraries-used-in-this-tutorial">
<h3>Import libraries used in this tutorial<a class="headerlink" href="#import-libraries-used-in-this-tutorial" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cdsapi</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># from netCDF4 import Dataset</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data-download-from-cds">
<h2>Data download from CDS<a class="headerlink" href="#data-download-from-cds" title="Link to this heading">#</a></h2>
<p>C3S GHG data products can be obtained from the CDS via the CDS user interface, or via the cdsapi as is demonstrated in this tutorial.</p>
<p>The satellite-derived CO2 products, and documentation are available here:
<a class="reference external" href="https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide">https://cds.climate.copernicus.eu/datasets/satellite-carbon-dioxide</a></p>
<p>Product XCO2_EMMA can be downloaded by manual selection in the “Download data” tab. Please select:</p>
<ul class="simple">
<li><p>Processing level: Level 2</p></li>
<li><p>Variable: Column-average dry-air mole fraction of atmospheric Carbon Dioxide (XCO2) and related variables</p></li>
<li><p>Sensor and algorithm: MERGED and EMMA</p></li>
</ul>
<p>For the following we assume that data for 2 days have been downloaded:</p>
<ul class="simple">
<li><p>File 1: 15-April-2020</p></li>
<li><p>File 2: 15-September-2020</p></li>
</ul>
<p>It is also assumed that the following version and format of the data is selected:</p>
<ul class="simple">
<li><p>Version: 4.4</p></li>
<li><p>Format: Zip file</p></li>
</ul>
<p>The corresponding file names are:</p>
<ul class="simple">
<li><p>File 1: 20200415-C3S-L2_GHG-GHG_PRODUCTS-MERGED-MERGED-EMMA-DAILY-v4.4.nc</p></li>
<li><p>File 2: 20200915-C3S-L2_GHG-GHG_PRODUCTS-MERGED-MERGED-EMMA-DAILY-v4.4.nc</p></li>
</ul>
<p>The following code block will download these data files and extract them to the current directory ready for use in this tutorial. This assumes that you have installed the cdsapi and configured you .cdsapirc file with your key, as described in the “Climate Data Store Tutorial”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">URL</span> <span class="o">=</span> <span class="s1">&#39;https://cds-beta.climate.copernicus.eu/api&#39;</span>
<span class="n">KEY</span> <span class="o">=</span> <span class="s1">&#39;#################&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download_zip_file</span> <span class="o">=</span> <span class="s2">&quot;download.zip&quot;</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;satellite-carbon-dioxide&quot;</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;processing_level&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;level_2&#39;</span><span class="p">],</span>
    <span class="s1">&#39;variable&#39;</span><span class="p">:</span> <span class="s1">&#39;xco2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sensor_and_algorithm&#39;</span><span class="p">:</span> <span class="s1">&#39;merged_emma&#39;</span><span class="p">,</span>
    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;2020&#39;</span><span class="p">],</span>
    <span class="s1">&#39;month&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;04&#39;</span><span class="p">,</span> <span class="s1">&#39;09&#39;</span><span class="p">],</span>
    <span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;15&#39;</span><span class="p">],</span>
    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;4_4&#39;</span><span class="p">],</span>
    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">cdsapi</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">URL</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">KEY</span><span class="p">)</span>
<span class="n">client</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">download_zip_file</span><span class="p">)</span>

<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">download_zip_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
    <span class="n">zf</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="set-some-options-that-are-used-in-this-tutorial">
<h3>Set some options that are used in this tutorial<a class="headerlink" href="#set-some-options-that-are-used-in-this-tutorial" title="Link to this heading">#</a></h3>
<p>Here some information on the selected product (which will be used later for the plots):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">product_id</span> <span class="o">=</span> <span class="s1">&#39;XCO2_EMMA&#39;</span> 
<span class="n">product_version</span> <span class="o">=</span> <span class="s1">&#39;4.4&#39;</span>  
<span class="n">product_str</span> <span class="o">=</span> <span class="n">product_id</span><span class="o">+</span><span class="s1">&#39; (v&#39;</span><span class="o">+</span><span class="n">product_version</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Here some information on the selected days and corresponding file names:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For file 1:</span>
<span class="n">year_1_str</span> <span class="o">=</span> <span class="s1">&#39;2020&#39;</span><span class="p">;</span> <span class="n">month_1_str</span> <span class="o">=</span> <span class="s1">&#39;04&#39;</span><span class="p">;</span> <span class="n">month_name_1_str</span> <span class="o">=</span> <span class="s1">&#39;Apr&#39;</span><span class="p">;</span> <span class="n">day_1_str</span> <span class="o">=</span> <span class="s1">&#39;15&#39;</span>
<span class="n">L2_file_1</span> <span class="o">=</span> <span class="s1">&#39;20200415-C3S-L2_GHG-GHG_PRODUCTS-MERGED-MERGED-EMMA-DAILY-v4.4.nc&#39;</span>
<span class="n">file_1_date</span> <span class="o">=</span> <span class="n">year_1_str</span><span class="o">+</span><span class="n">month_1_str</span><span class="o">+</span><span class="n">day_1_str</span>
<span class="n">file_1_date2</span> <span class="o">=</span> <span class="n">day_1_str</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">month_name_1_str</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">year_1_str</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">L2_file_1</span><span class="p">):</span>
   <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;File 1 exists: </span><span class="si">{</span><span class="n">L2_file_1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File 1 not found, please data downloaded and extracted correctly&#39;</span><span class="p">)</span>

<span class="c1"># For file 2:</span>
<span class="n">year_2_str</span> <span class="o">=</span> <span class="s1">&#39;2020&#39;</span><span class="p">;</span> <span class="n">month_2_str</span> <span class="o">=</span> <span class="s1">&#39;09&#39;</span><span class="p">;</span> <span class="n">month_name_2_str</span> <span class="o">=</span> <span class="s1">&#39;Sep&#39;</span><span class="p">;</span> <span class="n">day_2_str</span> <span class="o">=</span> <span class="s1">&#39;15&#39;</span>
<span class="n">L2_file_2</span> <span class="o">=</span> <span class="s1">&#39;20200915-C3S-L2_GHG-GHG_PRODUCTS-MERGED-MERGED-EMMA-DAILY-v4.4.nc&#39;</span>
<span class="n">file_2_date</span> <span class="o">=</span> <span class="n">year_2_str</span><span class="o">+</span><span class="n">month_2_str</span><span class="o">+</span><span class="n">day_2_str</span>
<span class="n">file_2_date2</span> <span class="o">=</span> <span class="n">day_2_str</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">month_name_2_str</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">year_2_str</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">L2_file_2</span><span class="p">):</span>
   <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;File 2 exists: </span><span class="si">{</span><span class="n">L2_file_2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File 2 not found, please data downloaded and extracted correctly&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="open-data-files-with-xarray">
<h2>Open data files with xarray<a class="headerlink" href="#open-data-files-with-xarray" title="Link to this heading">#</a></h2>
<p>We open the first file with xarray, and then set some of the variables to be coordinates (<code class="docutils literal notranslate"><span class="pre">latitude</span></code>, <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">time</span></code>).</p>
<p>The print out of the <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> allows you to explore the contents of the file. For this tutorial we will be using the <code class="docutils literal notranslate"><span class="pre">xco2</span></code> variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_1</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">L2_file_1</span><span class="p">)</span>

<span class="n">ds_1</span> <span class="o">=</span> <span class="n">ds_1</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span>
   <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="n">ds_1</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
   <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="n">ds_1</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
   <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">ds_1</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">ds_1</span>
</pre></div>
</div>
</div>
</div>
<p>Then repeat for file 2:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_2</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">L2_file_2</span><span class="p">)</span>

<span class="n">ds_2</span> <span class="o">=</span> <span class="n">ds_2</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">({</span>
   <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="n">ds_2</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
   <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="n">ds_2</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span>
   <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">ds_2</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">ds_2</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="application-1-the-latitudinal-distribution-of-xco2">
<h2>Application 1: The latitudinal distribution of XCO2<a class="headerlink" href="#application-1-the-latitudinal-distribution-of-xco2" title="Link to this heading">#</a></h2>
<p>Here our intention is to plot the data as a function of latitude. For this we first need to define the latitude bands.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* Computing latitude band center coordinates&#39;</span><span class="p">)</span>
<span class="n">lat_band_width</span> <span class="o">=</span> <span class="mf">10.0</span>  <span class="c1"># Width of latitude band in deg</span>
<span class="n">d_lat</span> <span class="o">=</span> <span class="n">lat_band_width</span><span class="o">*</span><span class="mf">0.5</span>
<span class="n">lat_band_min</span> <span class="o">=</span> <span class="o">-</span><span class="mf">90.0</span> <span class="o">+</span> <span class="n">d_lat</span>
<span class="n">lat_band_max</span> <span class="o">=</span> <span class="mf">90.0</span> <span class="o">-</span> <span class="n">d_lat</span>
<span class="n">lat_band_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="n">lat_band_width</span><span class="p">)</span>
<span class="n">n_lat_bands</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">lat_band_max</span> <span class="o">-</span> <span class="n">lat_band_min</span><span class="p">)</span> <span class="o">/</span> <span class="n">lat_band_width</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
<span class="n">lat_band_center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_lat_bands</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_lat_bands</span><span class="p">):</span>
   <span class="n">lat_band_center</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat_band_min</span> <span class="o">+</span> <span class="n">ii</span><span class="o">*</span><span class="n">lat_band_width</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* lat_band_center: &#39;</span><span class="p">,</span> <span class="n">lat_band_center</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* lat_band_bins: &#39;</span><span class="p">,</span> <span class="n">lat_band_bins</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="computing-xco2-vs-latitude">
<h3>Computing XCO2 vs latitude<a class="headerlink" href="#computing-xco2-vs-latitude" title="Link to this heading">#</a></h3>
<p>Now we compute the mean and standard deviation for each latitude band of XCO2 from files 1 and 2. As  we need to repeat this process for the data in file 1 and file 2, we will write a function to reduce the repetitive code.</p>
<p>(Note: we identify “No data” via a negative standard deviation)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">zonal_mean_and_std</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">lat_band_bins</span><span class="p">,</span> <span class="n">lat_band_centres</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;xco2&quot;</span><span class="p">):</span>
    <span class="c1"># Group the data by latitude bands</span>
    <span class="n">grouped</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span><span class="o">.</span><span class="n">groupby_bins</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="n">lat_band_bins</span><span class="p">)</span>

    <span class="c1"># Compute the zonal mean and standard deviation,</span>
    <span class="c1"># assign the latitude centres as coordinates, and use this as the dimension</span>
    <span class="n">zonal_mean</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">zonal_mean</span> <span class="o">=</span> <span class="n">zonal_mean</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude_bins&quot;</span><span class="p">,</span> <span class="n">lat_band_center</span><span class="p">))</span>
    <span class="n">zonal_mean</span> <span class="o">=</span> <span class="n">zonal_mean</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;latitude_bins&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">})</span>

    <span class="n">zonal_std</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">zonal_std</span> <span class="o">=</span> <span class="n">zonal_std</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;latitude_bins&quot;</span><span class="p">,</span> <span class="n">lat_band_center</span><span class="p">))</span>
    <span class="n">zonal_std</span> <span class="o">=</span> <span class="n">zonal_std</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;latitude_bins&#39;</span><span class="p">:</span> <span class="s1">&#39;latitude&#39;</span><span class="p">})</span>

    <span class="c1"># finally, we mask the data where the standard deviation is zero</span>
    <span class="n">zonal_mean</span> <span class="o">=</span> <span class="n">zonal_mean</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zonal_std</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">zonal_std</span> <span class="o">=</span> <span class="n">zonal_std</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">zonal_std</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">zonal_mean</span><span class="p">,</span> <span class="n">zonal_std</span>
</pre></div>
</div>
</div>
</div>
<p>Now calculate the mean and standard deviation using our function. We also caculate the mean+standard deviation and mean-standard deviation which will be used in the plot created below.</p>
<p>The print out of the xarray object shows that we have xco2 data in a DataArray with a single dimension, <code class="docutils literal notranslate"><span class="pre">latitude</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the mean and standard deviation of the Dataset for each latitude band</span>
<span class="n">xco2_lb_mean_1</span><span class="p">,</span> <span class="n">xco2_lb_std_1</span> <span class="o">=</span> <span class="n">zonal_mean_and_std</span><span class="p">(</span><span class="n">ds_1</span><span class="p">,</span> <span class="n">lat_band_bins</span><span class="p">,</span> <span class="n">lat_band_center</span><span class="p">)</span>
<span class="n">xco2_lb_low_1</span> <span class="o">=</span> <span class="n">xco2_lb_mean_1</span> <span class="o">-</span> <span class="n">xco2_lb_std_1</span>
<span class="n">xco2_lb_high_1</span> <span class="o">=</span> <span class="n">xco2_lb_mean_1</span> <span class="o">+</span> <span class="n">xco2_lb_std_1</span>

<span class="n">xco2_lb_mean_2</span><span class="p">,</span> <span class="n">xco2_lb_std_2</span> <span class="o">=</span> <span class="n">zonal_mean_and_std</span><span class="p">(</span><span class="n">ds_2</span><span class="p">,</span> <span class="n">lat_band_bins</span><span class="p">,</span> <span class="n">lat_band_center</span><span class="p">)</span>
<span class="n">xco2_lb_low_2</span> <span class="o">=</span> <span class="n">xco2_lb_mean_2</span> <span class="o">-</span> <span class="n">xco2_lb_std_2</span>
<span class="n">xco2_lb_high_2</span> <span class="o">=</span> <span class="n">xco2_lb_mean_2</span> <span class="o">+</span> <span class="n">xco2_lb_std_2</span>

<span class="n">xco2_lb_mean_1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="generation-of-xy-plot-showing-xco2-vs-latitude">
<h3>Generation of xy plot showing XCO2 vs latitude<a class="headerlink" href="#generation-of-xy-plot-showing-xco2-vs-latitude" title="Link to this heading">#</a></h3>
<p>We can now plot this data using <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* Generating XCO2 vs latitude plot ...&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">xmin</span> <span class="o">=</span> <span class="mf">404.0</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="mf">420.0</span>
<span class="n">ymin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">60.0</span>
<span class="n">ymax</span> <span class="o">=</span>  <span class="mf">80.0</span>

<span class="c1">#  Plot the data and the ranges:</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">xco2_lb_mean_1</span><span class="p">,</span> <span class="n">xco2_lb_mean_1</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">39</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean+/-Stddev &#39;</span><span class="o">+</span><span class="n">file_1_date2</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="p">[</span><span class="n">xco2_lb_low_1</span><span class="p">,</span> <span class="n">xco2_lb_high_1</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xco2_lb_mean_1</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">xco2_lb_mean_1</span><span class="o">.</span><span class="n">latitude</span><span class="p">],</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">38</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span>
<span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">xco2_lb_mean_2</span><span class="p">,</span> <span class="n">xco2_lb_mean_2</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">39</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mean+/-Stddev &#39;</span><span class="o">+</span><span class="n">file_1_date2</span>
<span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="p">[</span><span class="n">xco2_lb_low_2</span><span class="p">,</span> <span class="n">xco2_lb_high_2</span><span class="p">],</span>
    <span class="p">[</span><span class="n">xco2_lb_mean_2</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">xco2_lb_mean_2</span><span class="o">.</span><span class="n">latitude</span><span class="p">],</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">38</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span>
<span class="p">)</span>

<span class="c1"># Decorate the plot with some labels:</span>
<span class="n">title</span> <span class="o">=</span> <span class="n">product_str</span>
<span class="n">x_label</span> <span class="o">=</span> <span class="s1">&#39;XCO$_2$ [ppm]&#39;</span>
<span class="n">y_label</span> <span class="o">=</span> <span class="s1">&#39;Latitude [deg]&#39;</span>
<span class="n">plot_title</span> <span class="o">=</span> <span class="n">product_str</span><span class="o">+</span><span class="s1">&#39;: XCO$_2$ vs latitude&#39;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">plot_title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xbound</span><span class="p">([</span><span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ybound</span><span class="p">([</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The figure above shows mean value of XCO2 as a function of latitude (thick lines) and the corresponding variation (computed as standard deviation of the individual XCO2 retrievals) within each latitude band (semi-transparent horizontal bars) for 15-April-2020 (red) and 15-September-2020 (black). As can be seen, during September XCO2 shows quite little variation with latitude, whereas in April XCO2 is significantly higher over the northern hemisphere (NH) compared to the southern hemisphere (SH). This is due to the seasonal cycle of CO2 primarily resulting from regular uptake and release of atmospheric CO2 by growing and decaying vegetation (photosythesis and respiration). Vegetation uptake reduces the CO2 concentration over the NH during the growing season (spring and summer) compared to the dormant season (winter). Over the SH there is less vegetation and therefore CO2 is relatively constant (apart from the general increase due to CO2 emissions by burning fossil fuels).</p>
</section>
</section>
<section id="application-2-showing-daily-data-on-a-map">
<h2>Application 2: Showing daily data on a map<a class="headerlink" href="#application-2-showing-daily-data-on-a-map" title="Link to this heading">#</a></h2>
<p>Here we show how to generate a plot showing the spatial distribution of the data. As can be seen, we use only three variables: XCO2, latitude and longitude. We define a small region in terms of latitude and longitude corner coordinates and select only data in this region for the plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;* Generating XCO2 map ...&#39;</span><span class="p">)</span>
<span class="c1"># # Relevant input data:</span>
<span class="n">plot_title</span> <span class="o">=</span> <span class="n">product_str</span><span class="o">+</span><span class="s1">&#39; - &#39;</span><span class="o">+</span><span class="n">file_2_date2</span>
<span class="c1"># Define spatial region of interest:</span>
<span class="n">lonmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">12.0</span>
<span class="n">lonmax</span> <span class="o">=</span>  <span class="mf">35.0</span>
<span class="n">latmin</span> <span class="o">=</span>  <span class="mf">32.0</span>
<span class="n">latmax</span> <span class="o">=</span>  <span class="mf">65.0</span>

<span class="c1"># Mask the data to the region of interest:</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds_2</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">latmin</span><span class="o">&lt;</span><span class="n">ds</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">latitude</span> <span class="o">&lt;</span><span class="n">latmax</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">lonmin</span><span class="o">&lt;</span><span class="n">ds</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">longitude</span> <span class="o">&lt;</span><span class="n">lonmax</span><span class="p">)</span>
<span class="p">)</span>
<span class="c1"># Get the min and max values for the colorbar:</span>
<span class="n">rmin</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">xco2</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">rmax</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">xco2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># Create a figure with a geographic projection:</span>
<span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
<span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="n">lonmin</span><span class="p">,</span> <span class="n">lonmax</span><span class="p">,</span> <span class="n">latmin</span><span class="p">,</span> <span class="n">latmax</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;powderblue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span>  <span class="o">=</span> <span class="kc">False</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">xco2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span>
    <span class="n">vmin</span><span class="o">=</span><span class="n">rmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">rmax</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;XCO$_2$ [ppm]&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The figure above shows the locations of the individual ground pixel observations and their corresponding XCO2 value using all “good” retrievals over Europe and surrounding area for 15-Sept-2020. As can be seen, the spatial coverage of the daily data is very sparse. This is because only data of the highest quality are contained in the product file. Strict quality filtering is important to meet the demanding requirements on accuracy and precision for satellite XCO2 data observations.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ecv-notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="cloud-cover-climatology.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Calculation of global climatology and annual cycles of Cloud Fractional Cover from EUMETSAT’s CM SAF CLARA-A3 dataset</p>
      </div>
    </a>
    <a class="right-next"
       href="greenhouse-gases-level3-products.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">How to access, read and use satellite XCO2 and XCH4 Level 3 data products</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-needed-to-use-this-jupyter-notebook">What is needed to use this Jupyter Notebook?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries-used-in-this-tutorial">Import libraries used in this tutorial</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-download-from-cds">Data download from CDS</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#set-some-options-that-are-used-in-this-tutorial">Set some options that are used in this tutorial</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-data-files-with-xarray">Open data files with xarray</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-1-the-latitudinal-distribution-of-xco2">Application 1: The latitudinal distribution of XCO2</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computing-xco2-vs-latitude">Computing XCO2 vs latitude</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generation-of-xy-plot-showing-xco2-vs-latitude">Generation of xy plot showing XCO2 vs latitude</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#application-2-showing-daily-data-on-a-map">Application 2: Showing daily data on a map</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By the Copernicus Climate Change Service (C3S), entrusted to ECMWF (European Centre for Medium-Range Weather Forecasts)
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>